function showThumb(e){if(e[0]){var t=".vimeo-"+e[0].id;$(t).each(function(){$(this).attr("src",e[0].thumbnail_medium)})}}function vimeoLoadingThumb(e){var t=document.location.protocol+"//vimeo.com/api/v2/video/"+e+".json?callback=showThumb",i=".vimeo-"+e;$(i).each(function(){$(this).before('<script type="text/javascript" src="'+t+'"><\/script>')})}function delay(e,t){var i=0;return function(){var n=this,o=arguments;clearTimeout(i),i=setTimeout(function(){e.apply(n,o)},t||0)}}!function(e){function t(e){var t=parseInt(e.val());return isNaN(t)?0:t}e.fn.incrementalInput=function(i){var n={inputClass:".js-incremental-input",plusClass:".js-incremental-plus",minusClass:".js-incremental-minus",step:1,max:!1,min:!1,canChange:function(){return!0},onIncrease:function(){},onDecrease:function(){},onChange:function(){}},o=e.extend(!0,{},n,i);return this.each(function(){var i=e(this),n=i.find(o.inputClass);i.find(o.plusClass).on("click",function(e){if(!o.canChange(n))return!1;var i=t(n);return n.prevValue=i,i+=o.step,!1!==o.max&&i>o.max&&(i=o.max),n.val(i),o.onIncrease(n,i,n.prevValue),o.onChange(n,i,n.prevValue),!1}),i.find(o.minusClass).on("click",function(){if(!o.canChange(n))return!1;var e=t(n);return n.prevValue=e,e-=o.step,!1!==o.min&&e<o.min&&(e=o.min),n.val(e),o.onDecrease(n,e,n.prevValue),o.onChange(n,e,n.prevValue),!1})})}}(window.jQuery),function(){function addEvent(e,t,i){if(e.addEventListener)e.addEventListener(t,i,!1);else{if(!e.attachEvent)throw new Error("not supported or DOM not loaded");e.attachEvent("on"+t,function(){i.call(e)})}}function addResizeEvent(e){var t;addEvent(window,"resize",function(){t&&clearTimeout(t),t=setTimeout(e,100)})}function getBox(e){var t,i,n,o,a=getOffset(e);return t=a.left,n=a.top,i=t+e.offsetWidth,o=n+e.offsetHeight,{left:t,right:i,top:n,bottom:o}}function addStyles(e,t){for(var i in t)t.hasOwnProperty(i)&&(e.style[i]=t[i])}function copyLayout(e,t){var i=getBox(e);addStyles(t,{position:"absolute",left:i.left+"px",top:i.top+"px",width:e.offsetWidth+"px",height:e.offsetHeight+"px"})}function fileFromPath(e){return e.replace(/.*(\/|\\)/,"")}function getExt(e){return-1!==e.indexOf(".")?e.replace(/.*[.]/,""):""}function hasClass(e,t){return new RegExp("\\b"+t+"\\b").test(e.className)}function addClass(e,t){hasClass(e,t)||(e.className+=" "+t)}function removeClass(e,t){var i=new RegExp("\\b"+t+"\\b");e.className=e.className.replace(i,"")}function removeNode(e){e.parentNode.removeChild(e)}if(document.documentElement.getBoundingClientRect)var getOffset=function(e){var t=e.getBoundingClientRect(),i=e.ownerDocument,n=i.body,o=i.documentElement,a=o.clientTop||n.clientTop||0,r=o.clientLeft||n.clientLeft||0,s=1;if(n.getBoundingClientRect){var d=n.getBoundingClientRect();s=(d.right-d.left)/n.clientWidth}return s>1&&(a=0,r=0),{top:t.top/s+(window.pageYOffset||o&&o.scrollTop/s||n.scrollTop/s)-a,left:t.left/s+(window.pageXOffset||o&&o.scrollLeft/s||n.scrollLeft/s)-r}};else var getOffset=function(e){var t=0,i=0;do{t+=e.offsetTop||0,i+=e.offsetLeft||0,e=e.offsetParent}while(e);return{left:i,top:t}};var toElement=function(){var e=document.createElement("div");return function(t){e.innerHTML=t;var i=e.firstChild;return e.removeChild(i)}}(),getUID=function(){var e=0;return function(){return"ValumsAjaxUpload"+e++}}();window.AjaxUpload=function(e,t){this._settings={action:"upload.php",name:"userfile",multiple:!1,data:{},autoSubmit:!0,responseType:!1,hoverClass:"hover",focusClass:"focus",disabledClass:"disabled",onChange:function(e,t){},onSubmit:function(e,t){},onComplete:function(e,t){}};for(var i in t)t.hasOwnProperty(i)&&(this._settings[i]=t[i]);if(e.jquery?e=e[0]:"string"==typeof e&&(/^#.*/.test(e)&&(e=e.slice(1)),e=document.getElementById(e)),!e||1!==e.nodeType)throw new Error("Please make sure that you're passing a valid element");"A"==e.nodeName.toUpperCase()&&addEvent(e,"click",function(e){e&&e.preventDefault?e.preventDefault():window.event&&(window.event.returnValue=!1)}),this._button=e,this._input=null,this._disabled=!1,this.enable(),this._rerouteClicks()},AjaxUpload.prototype={setData:function(e){this._settings.data=e},disable:function(){addClass(this._button,this._settings.disabledClass),this._disabled=!0;var e=this._button.nodeName.toUpperCase();"INPUT"!=e&&"BUTTON"!=e||this._button.setAttribute("disabled","disabled"),this._input&&this._input.parentNode&&(this._input.parentNode.style.visibility="hidden")},enable:function(){removeClass(this._button,this._settings.disabledClass),this._button.removeAttribute("disabled"),this._disabled=!1},_createInput:function(){var e=this,t=document.createElement("input");t.setAttribute("type","file"),t.setAttribute("name",this._settings.name),this._settings.multiple&&t.setAttribute("multiple","multiple"),addStyles(t,{position:"absolute",right:0,margin:0,padding:0,fontSize:"480px",fontFamily:"sans-serif",cursor:"pointer"});var i=document.createElement("div");if(addStyles(i,{display:"block",position:"absolute",overflow:"hidden",margin:0,padding:0,opacity:0,direction:"ltr",zIndex:2147483583}),"0"!==i.style.opacity){if(void 0===i.filters)throw new Error("Opacity not supported by the browser");i.style.filter="alpha(opacity=0)"}addEvent(t,"change",function(){if(t&&""!==t.value){var i=fileFromPath(t.value);if(!1===e._settings.onChange.call(e,i,getExt(i)))return void e._clearInput();e._settings.autoSubmit&&e.submit()}}),addEvent(t,"mouseover",function(){addClass(e._button,e._settings.hoverClass)}),addEvent(t,"mouseout",function(){removeClass(e._button,e._settings.hoverClass),removeClass(e._button,e._settings.focusClass),t.parentNode&&(t.parentNode.style.visibility="hidden")}),addEvent(t,"focus",function(){addClass(e._button,e._settings.focusClass)}),addEvent(t,"blur",function(){removeClass(e._button,e._settings.focusClass)}),i.appendChild(t),document.body.appendChild(i),this._input=t},_clearInput:function(){this._input&&(removeNode(this._input.parentNode),this._input=null,this._createInput(),removeClass(this._button,this._settings.hoverClass),removeClass(this._button,this._settings.focusClass))},_rerouteClicks:function(){var e=this;addEvent(e._button,"mouseover",function(){if(!e._disabled){e._input||e._createInput();var t=e._input.parentNode;copyLayout(e._button,t),t.style.visibility="visible"}})},_createIframe:function(){var e=getUID(),t=toElement('<iframe src="javascript:false;" name="'+e+'" />');return t.setAttribute("id",e),t.style.display="none",document.body.appendChild(t),t},_createForm:function(e){var t=this._settings,i=toElement('<form method="post" enctype="multipart/form-data"></form>');i.setAttribute("action",t.action),i.setAttribute("target",e.name),i.style.display="none",document.body.appendChild(i);for(var n in t.data)if(t.data.hasOwnProperty(n)){var o=document.createElement("input");o.setAttribute("type","hidden"),o.setAttribute("name",n),o.setAttribute("value",t.data[n]),i.appendChild(o)}return i},_getResponse:function(iframe,file){var toDeleteFlag=!1,self=this,settings=this._settings;addEvent(iframe,"load",function(){if("javascript:'%3Chtml%3E%3C/html%3E';"==iframe.src||"javascript:'<html></html>';"==iframe.src)return void(toDeleteFlag&&setTimeout(function(){removeNode(iframe)},0));var doc=iframe.contentDocument?iframe.contentDocument:window.frames[iframe.id].document;if(!(doc.readyState&&"complete"!=doc.readyState||doc.body&&"false"==doc.body.innerHTML)){var response;doc.XMLDocument?response=doc.XMLDocument:doc.body?(response=doc.body.innerHTML,settings.responseType&&"json"==settings.responseType.toLowerCase()&&(doc.body.firstChild&&"PRE"==doc.body.firstChild.nodeName.toUpperCase()&&(doc.normalize(),response=doc.body.firstChild.firstChild.nodeValue),response=response?eval("("+response+")"):{})):response=doc,settings.onComplete.call(self,file,response),toDeleteFlag=!0,iframe.src="javascript:'<html></html>';"}})},submit:function(){var e=this,t=this._settings;if(this._input&&""!==this._input.value){var i=fileFromPath(this._input.value);if(!1===t.onSubmit.call(this,i,getExt(i)))return void this._clearInput();var n=this._createIframe(),o=this._createForm(n);removeNode(this._input.parentNode),removeClass(e._button,e._settings.hoverClass),removeClass(e._button,e._settings.focusClass),o.appendChild(this._input),o.submit(),removeNode(o),o=null,removeNode(this._input),this._input=null,this._getResponse(n,i),this._createInput()}}}}(),function(e){e.fn.endlessScroll=function(t){var i={bottomPixels:50,fireOnce:!0,fireDelay:150,loader:"<br />Loading...<br />",data:!1,url:!1,params:{},toElement:!1,success:function(){},error:function(){},insertAfter:"div:last",resetCounter:function(){return!1},callback:function(){return!0},ceaseFire:function(){return!1},disable:!1},t=e.extend({},i,t),n=!1,o=!0,a=!1,r=0;!0===t.ceaseFire.apply(this)&&(o=!1);var s=this;if(!0===o){if(!1===t.toElement)var d=s;else var d=window;e(d).scroll(function(){if(!n){if(!0===t.ceaseFire.apply(this)||t.disable)return void s.unbind("scroll");if(s==document||s==window)var i=e(document).height()-e(window).height()<=e(window).scrollTop()+t.bottomPixels;else if(!1===t.toElement){var o=e(".endless_scroll_inner_wrap",this);0==o.length&&(o=e(this).wrapInner('<div class="endless_scroll_inner_wrap" />').find(".endless_scroll_inner_wrap"));var i=o.length>0&&o.height()-e(this).height()<=e(this).scrollTop()+t.bottomPixels}else var d=e(s).offset(),c=d.top,i=c<=e(window).height()+e(window).scrollTop()+t.bottomPixels;i&&(0==t.fireOnce||1==t.fireOnce&&1!=a)&&(!0===t.resetCounter.apply(this)&&(r=0),a=!0,r++,e(t.insertAfter).after('<div id="endless_scroll_loader">'+t.loader+"</div>"),!1===t.url&&!1===t.data||(!1!==t.url?(n=!0,e.ajax({url:t.url,type:"POST",data:t.params,success:function(i){n=!1,e("div#endless_scroll_loader").remove();var o="function"==typeof t.success&&t.success.apply(this,[i,t,r]);!1!==o?e(t.insertAfter).after(o):s.unbind("scroll"),t.disable&&s.unbind("scroll"),t.callback.apply(this,[r])},error:function(){e("div#endless_scroll_loader").remove(),"function"==typeof t.error&&t.error.apply(this,[r]),s.unbind("scroll"),t.callback.apply(this,[r])},dataType:"json"})):(data="function"==typeof t.data?t.data.apply(this,[t,r]):t.data,e(t.insertAfter).after('<div id="endless_scroll_data">'+data+"</div>"),e("div#endless_scroll_data").hide().fadeIn(),e("div#endless_scroll_data").removeAttr("id"),e("div#endless_scroll_loader").remove(),t.callback.apply(this,[r])),!1!==t.fireDelay||0!==t.fireDelay?(e("body").after('<div id="endless_scroll_marker"></div>'),e("div#endless_scroll_marker").fadeTo(t.fireDelay,1,function(){e(this).remove(),a=!1})):a=!1),t.disable&&s.unbind("scroll"))}})}}}(jQuery),view={_lang:void 0,getLang:function(){return void 0===this._lang&&$(function(){this._lang=$("#top-body").data("lang")?$("#top-body").data("lang"):"ru"}),this._lang},translate:function(e){return"ru"!=this.getLang()&&void 0!=e&&""!=e&&void 0!=window.Translate?Translate[e]||e:e},query:function(e,t,i,n,o,a,r){var s=o||"json",d=n||{},c=r||{};$.ajax({url:e,type:"POST",dataType:s,data:d,timeout:3e4,success:function(e,n){try{if(e&&1==e.success)t(e,n);else if(void 0!=a&&a(e,n),void 0==a||void 0!=c.showError&&1==c.showError){var o;if(o=c.msg?c.msg:"json"==s?void 0!=e.msg?e.msg:"":$(e).closest(".block-error").length>0?$(e).html():"",!e.type||"warning"!=e.type)throw new Error(o);ntNotification.showWarning(e.message),Popup.progressBar("hide")}}catch(e){Notifier.showError(e.message,i)}},error:function(e,t){var n=Notifier.getErrorTpl(t);Notifier.showError(n,i),Popup.progressBar("hide")}})},scrollTo:function(e,t){if(0==$("#"+e).length)return!1;t|=500;var i=$("#"+e).offset();return $("body, html").animate({scrollTop:i.top},t),!0},toogleBlockByClick:function(e,t){var i=$(e);$(document).on("click",i.selector,function(){return $(t).toggle(),!1})},array_unique:function(e){for(var t=[],i=e.length,n=0;n<i;n++){for(var o=n+1;o<i;o++)e[n]===e[o]&&(o=++n);t.push(e[n])}return t},isInt:function(e){return!isNaN(e)&&parseInt(e)==e&&!/^0[x|X]\.*/i.test(e)&&e>=0},getTld:function(){return $("body").data("tld")},setPhoneValidator:function(){var e=view.getTld(),t=/^$/i;switch(e){case"ru":t=/^\+7\(\d{3}\)\d{7}$/i;break;case"ua":t=/^\+380\(\d{3}\)\d{7}$/i}return jQuery.validator.addMethod("phoneNumber",function(e,i){return this.optional(i)||t.test(e)},this.translate("Введите корректный телефон")),!0}};var Notifier={ask:function(e){return confirm(e)},addPreloader:function(e){0==$(e).find(".preloader").length&&(e.append('<div class="bg">'),e.append('<div class="preloader">'))},removePreloader:function(e){0!=$(e).find(".preloader").length&&(e.find(".bg").remove(),e.find(".preloader").remove())},hasPreloader:function(e){return 0!=$(e).find(".preloader").length},getErrorTpl:function(e){return view.translate("Ошибка")+": "+e+"."+view.translate("Попробуйте запрос позже")+"."},_showPopup:function(e){var t=this;t.popupTemlate?t._initPopup(e):$.get("/html/ru_RU/utils/notifyer.html",function(i){t.popupTemlate=i,$(document).on("click",".window.notifyer .-btn",function(){Popup.closeDialog()}),$(document).on("click",".window.notifyer a",function(){return Popup.closeDialog(),t.to_href=$(this).attr("href"),!1}),t._initPopup(e)})},_initPopup:function(e){var t=this,i=$(this.popupTemlate);i.find(".header").html(e.head),i.find(".message").html(e.msg),i.addClass(e.type),i.find(".-btn").addClass("-btn-"+e.type);var n=Popup.getParams();n.padding=0,n.afterClose=function(){t.to_href&&(window.location.href="http://"+window.location.host+t.to_href,$(document).trigger("hashchange")),t.to_href=!1},Popup.showDialog(i,n)},showError:function(e,t,i,n){var o=this;i=void 0==i||i,e=e||"Произошла ошибка. Попробуйте еще.",e=view.translate(e),n=n||"Произошла ошибка",n=view.translate(n),void 0!=t&&$(t).length>0?o.notify({type:"error",msg:e,el:t,hide:i}):o._showPopup({head:n,msg:e,type:"error"})},showSuccess:function(e,t,i,n){var o=this;i=void 0==i||i,e=e||view.translate("Операция выполнена успешно"),e=view.translate(e),n=n||"Операция выполнена успешно",n=view.translate(n),void 0!=t&&$(t).length>0?this.notify({type:"success",msg:e,el:t,hide:i}):o._showPopup({head:n,msg:e,type:"success"})},showWarning:function(e,t,i,n){var o=this;e=e||view.translate("Предупреждение"),e=view.translate(e),n=n||"Уведомление",n=view.translate(n),o._showPopup({head:n,msg:e,type:"warning"})},showMessage:function(e,t,i,n){var o=void 0==i||i;void 0!=t&&$(t).length>0?(n=n||void 0,this.notify({type:"ok",msg:e,el:t,hide:o,speedOut:n})):void 0!=e&&alert(e)},notify:function(e){var t=this.getTemplate();1==e.hide&&$("."+$(t).attr("class")).fadeOut(),$(t).addClass(e.type).html('<table><td><div id="'+e.type+'-icon"></div></td><td>'+e.msg+"</td></table>"),$(e.el).prepend($(t)),$(t).fadeIn();var i=$(e.el).position().top;if($(e.el).scrollTop()>0&&$("body,html").animate({scrollTop:i},200),1==e.hide){var n=e.speedOut||5e3;setTimeout(function(){$(t).fadeOut(),$(t).remove()},n)}},getTemplate:function(){return $('<div class="notifier"/>')},showIndicator:function(e,t){var i=this.getIndicatorBtn(e,t);this.showIndicatorBtn(i)},hideIndicator:function(e,t){var i=this.getIndicatorBtn(e,t);this.hideIndicatorBtn(i)},lockBtn:function(e){e.hasClass("disable")||e.addClass("disable")},unlockBtn:function(e){e.removeClass("disable")},showIndicatorBtn:function(e){e.attr("style","width:"+e.innerWidth()+"px"),e.addClass("locked"),e.prepend('<div class="-loader"></div>'),e.on("click.off",function(){return!1})},hideIndicatorBtn:function(e){e.removeClass("locked"),e.children(".-loader").remove(),e.attr("style",""),e.off("click.off")},getIndicatorBtn:function(e,t){return 0==(t||!1)?0==$("#"+e+" button.blue, #"+e+" .-btn-complete").length?$("#"+e+" .buttons.green-btn"):$("#"+e+" button.blue,#"+e+" .-btn-complete"):$("#"+e+" footer button.blue, #"+e+" footer .-btn-complete")},getLoader:function(){return'<div id="ajax-loader"></div>'},showNotice:function(e,t,i){var n=$(e);if(n.length>0){var o=$('<div id="user-notice" style="display:none;">'+t+"</div>"),a=n.find("#user-notice");i&&a.length?a.eq(0).replaceWith(o):n.append(o),o.fadeIn(200),setTimeout(function(){o.fadeOut(200,function(){o.remove()})},2500)}},getSmallLoader:function(){return"<img id='lazy-loader' src='//s.siteapi.org/frontend/static/grid_6/img/lazyload-da16aabf34.gif'>"},removeSmallLoader:function(){$("#lazy-loader").remove()}},__awaiter=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,a){function r(e){try{d(n.next(e))}catch(e){a(e)}}function s(e){try{d(n.throw(e))}catch(e){a(e)}}function d(e){e.done?o(e.value):new i(function(t){t(e.value)}).then(r,s)}d((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,a&&(r=a[2&i[0]?"return":i[0]?"throw":"next"])&&!(r=r.call(a,i[1])).done)return r;switch(a=0,r&&(i=[0,r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,a=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!(r=r.length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],a=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var o,a,r,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return{next:i(0),throw:i(1),return:i(2)}},Notifier={ask:function(e){return confirm(e)},addPreloader:function(e){0==$(e).find(".preloader").length&&(e.append('<div class="bg">'),e.append('<div class="preloader">'))},removePreloader:function(e){0!=$(e).find(".preloader").length&&(e.find(".bg").remove(),e.find(".preloader").remove())},hasPreloader:function(e){return 0!=$(e).find(".preloader").length},getErrorTpl:function(e){return view.translate("Ошибка")+": "+e+"."+view.translate("Попробуйте запрос позже")+"."},_showPopup:function(e){var t=this;t.popupTemlate?t._initPopup(e):$.get("/html/ru_RU/utils/notifyer.html",function(i){t.popupTemlate=i,$(document).on("click",".window.notifyer .-btn",function(){Popup.closeDialog()}),$(document).on("click",".window.notifyer a",function(){return Popup.closeDialog(),t.to_href=$(this).attr("href"),!1}),t._initPopup(e)})},_initPopup:function(e){var t=this,i=$(this.popupTemlate);i.find(".header").html(e.head),i.find(".message").html(e.msg),i.addClass(e.type),i.find(".-btn").addClass("-btn-"+e.type);var n=Popup.getParams();n.padding=0,n.afterClose=function(){t.to_href&&(window.location.href=document.location.protocol+"://"+window.location.host+t.to_href,$(document).trigger("hashchange")),t.to_href=!1},Popup.showDialog(i,n)},showError:function(e,t,i,n){var o=this;i=void 0==i||i,e=e||"Произошла ошибка. Попробуйте еще.",e=view.translate(e),n=n||"Произошла ошибка",n=view.translate(n),void 0!=t&&$(t).length>0?o.notify({type:"error",msg:e,el:t,hide:i}):ntNotification.showError('<div class="-f-bold"><b>'+n+"</b></div><div>"+e+"</div>")},showSuccess:function(e,t,i,n){i=void 0==i||i,e=e||view.translate("Операция выполнена успешно"),e=view.translate(e),n=n||"Операция выполнена успешно",n=view.translate(n),void 0!=t&&$(t).length>0?this.notify({type:"success",msg:e,el:t,hide:i}):ntNotification.showSuccess('<div class="-f-bold"><b>'+n+"</b></div><div>"+e+"</div>")},showWarning:function(e,t,i,n){e=e||view.translate("Предупреждение"),e=view.translate(e),n=n||"Уведомление",n=view.translate(n),ntNotification.showWarning('<div class="-f-bold"><b>'+n+"</b></div><div>"+e+"</div>")},showMessage:function(e,t,i,n){var o=void 0==i||i;void 0!=t&&$(t).length>0?(n=n||void 0,this.notify({type:"ok",msg:e,el:t,hide:o,speedOut:n})):void 0!=e&&alert(e)},notify:function(e){var t=this.getTemplate();1==e.hide&&$("."+$(t).attr("class")).fadeOut(),$(t).addClass(e.type).html('<table><td><div id="'+e.type+'-icon"></div></td><td>'+e.msg+"</td></table>"),$(e.el).prepend($(t)),$(t).fadeIn();var i=$(e.el).position().top;if($(e.el).scrollTop()>0&&$("body,html").animate({scrollTop:i},200),1==e.hide){var n=e.speedOut||5e3;setTimeout(function(){$(t).fadeOut(),$(t).remove()},n)}},getTemplate:function(){return $('<div class="notifier"/>')},showIndicator:function(e,t){var i=this.getIndicatorBtn(e,t);this.showIndicatorBtn(i)},hideIndicator:function(e,t){var i=this.getIndicatorBtn(e,t);this.hideIndicatorBtn(i)},lockBtn:function(e){e.hasClass("disable")||e.addClass("disable")},unlockBtn:function(e){e.removeClass("disable")},showIndicatorBtn:function(e){e.attr("style","width:"+e.innerWidth()+"px"),e.addClass("locked"),e.prepend('<div class="-loader"></div>'),e.on("click.off",function(){return!1})},hideIndicatorBtn:function(e){e.removeClass("locked"),e.children(".-loader").remove(),e.attr("style",""),e.off("click.off")},getIndicatorBtn:function(e,t){return 0==(t||!1)?0==$("#"+e+" button.blue, #"+e+" .-btn-complete").length?$("#"+e+" .buttons.green-btn"):$("#"+e+" button.blue,#"+e+" .-btn-complete"):$("#"+e+" footer button.blue, #"+e+" footer .-btn-complete")},getLoader:function(){return'<div id="ajax-loader"></div>'},showNotice:function(e,t,i){var n=$(e);if(n.length>0){var o=$('<div id="user-notice" style="display:none;">'+t+"</div>"),a=n.find("#user-notice");i&&a.length?a.eq(0).replaceWith(o):n.append(o),o.fadeIn(200),setTimeout(function(){o.fadeOut(200,function(){o.remove()})},2500)}},getSmallLoader:function(){return"<img id='lazy-loader' src='//s.siteapi.org/frontend/static/grid_6/img/lazyload-da16aabf34.gif'>"},removeSmallLoader:function(){$("#lazy-loader").remove()}},Popup={loadEvents:function(){var e=this;$(document).on("click",".window .close, .window .close-link a, .window .cancel,.window .-btn-cancel",function(){return 0==$(this).parents("#comment_form").length&&(e.closeDialog(),$.jPicker&&$.jPicker.List.forEach(function(e){e.hide()})),!1})},getParams:function(){return{closeBtn:!1,enableEscapeButton:!0,margin:0,padding:2,scrolling:!1,minHeight:1,minWidth:1}},showDialog:function(e,t){var i=this,n=t||i.getParams();n=$.extend({},n,{content:e}),Visitor.bindImageViewer($,n)},showWindow:function(e,t,i,n){var o='<section class="window '+i+'" id="'+i+'-edit-window" style="width:'+n+'px"><header><div class="edit-block"><ul><li><span class="close"></span></li></ul></div><h1>'+view.translate(t)+'</h1></header><div id="windowContent">'+e+"</div></section>";this.showDialog(o)},closeDialog:function(){$.fancybox.close()},progressBar:function(e){"show"==e?$.fancybox.showLoading():$.fancybox.hideLoading()},center:function(){}};Visitor={init:function(){this.setTooltip(),$("#footer").append($('<div id="temp-block"/>')),this.loadEvents(),this._initValidate(),Popup.loadEvents();var e=$("#top-body").data("lang");this.lang=void 0==e?"ru":e,this.scrollWindow=0,this.isFancyLoad=!1,this.setSrcToFrameMap(),setTimeout(function(){Visitor.checkViewer()},1e3),this.addValidateMethods(),this.subscriberAddFormValidate(),this.initCatalogPriceFilter(),OneClickBuy.init(),this.formsHashHandler(),$(window).on("hashchange",$.proxy(function(){this.formsHashHandler()},this)),this.initDropDown(),$(document).on("widget_set_content",function(e,t){11==t&&(this.initDropDown(),Visitor.initCatalogPriceFilter())}.bind(this)),this.initTab()},initCatalogPriceFilter:function(){var e=$("#catalog_price_filter");if(0!=e.length){var t,i,n=$("#catalog_price_filter_min_cost"),o=$("#catalog_price_filter_max_cost");i=n.data("min-cost")?parseInt(n.data("min-cost")):0,t=o.data("max-cost")?parseInt(o.data("max-cost")):1e4,e.html(""),n.val()||n.val(i),o.val()||o.val(t);try{noUiSlider.create(e[0],{start:[parseInt(n.val()),parseInt(o.val())],range:{min:i,max:t},format:{to:function(e){return parseInt(e)},from:function(e){return e}},connect:!0}),e[0].noUiSlider.on("update",function(e,t){1==t?o.val(e[t]):n.val(e[t])}),n.on("change",function(){e[0].noUiSlider.set([n.val(),o.val()])}),o.on("change",function(){e[0].noUiSlider.set([n.val(),o.val()])})}catch(e){}}},setTooltip:function(){$(document).on("mouseover",".tooltip:not(.tooltipstered)",function(){var e=$(this);e.tooltipster({touchDevices:!1}),e.tooltipster("show")})},addValidateMethods:function(){$.validator.setDefaults({onclick:function(e,t){$(e).valid()&&$(e).removeClass("error")},onkeyup:function(e,t){9===t.which&&""===this.elementValue(e)||$(e).valid()&&$(e).removeClass("error")}}),$.validator.addMethod("identity",function(e,t){var i=e.trim();return this.optional(t)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(i)},view.translate("Введите корректный email")),$.validator.addMethod("phone",function(e,t){var i=e.trim();return this.optional(t)||/^[+]?(\d)+$/i.test(i)})},loadEvents:function(){var e=this;$(document).on("click",".ddelivery-map",function(){var e=$(this).data("city-type");Popup.showDialog('<iframe src="http://service.ddelivery.ru/demodev/ddelivery/ajax.php?iframe=1&amp;config_type=3&amp;width=900&amp;height=580&config_city='+e+'" height="600" width="920"></iframe>',{closeBtn:!1,enableEscapeButton:!0,margin:0,padding:[20,0,0,20],scrolling:!1,minHeight:1,minWidth:1})}),e.scrllWidth=e.scrollbarWidth(),$(document).on("click",".mailerForm .send",function(){$(".mailerForm form").submit()}),$(document).on("click","#topcontacts .feedback-btn",function(e){Feedback.init($(this).data("type"))}),$(document).on("click","#up-link",function(t){return e.scrollTop(t)}),$(document).on("mouseover","#up-link",function(){$(this).stop(!0,!0).animate({opacity:1},200)}),$(document).on("mouseout","#up-link",function(){$(this).stop(!0,!0).animate({opacity:.4},200)}),$(window).scroll(function(){e.showUpLink(this)}),$(document).on("click",".buttons.order",function(){e.makeOrder(this)}),document.onkeydown=function(t){e.keyEvents(t)},$(document).on("mouseover.fancy",".fancy-img",function(){var e=$(".fancy-img");return Nethouse.Modal.imageGallery(e.filter(function(){return $(this).find("img").is(":visible")})),$(document).off("mouseover.fancy",".fancy-img"),!1}),$(document).on("click",".fancy-img-post",function(){var e=$(this);e.parent().is("a")||0!=e.parents(".mrb-grid").length||Nethouse.Modal.item(e.attr("data-eval"),{type:"image"})}),$(document).on("click",".video-intext",function(){e.getVideo(this)}),$(document).on("click",".buttons.disable",function(){return!1}),$(document).on("click",".video-item a, .video-link",function(){e.showVideo($(this))}),$(document).on("click",".fancybox-wrap.can-close",function(e){e.target==this&&$.fancybox.close()}),$(document).on("click","#contactsmain-left .ymap, #contactsmain .ymap, #contactsmain-left .gmap, #contactsmain .gmap, #contactsmain-left .2gismap, #contactsmain .2gismap",function(){return e.findAddress(this),!1}),$(document).on("click","#sharebyemail-edit-window footer .save",function(){$("form#sharebyemail").submit()}),$(document).on("click",".error-window .ok,.success-window .ok",function(){Popup.closeDialog()}),$(document).on("click",".top-news .popup",function(){return e.getUrgentMessage()}),$(document).on("click","#blog-posts-lnk",function(){return e.setPostCounterNull()}),$(document).on("change","select#translate",function(){return e.toggleLanguage(this)}),$(document).on("click",".window .show-form a",function(){return $(this).parent().parent().find("form").slideToggle(),!1}),$(document).on("click",".window #comment_wrap .show-all",function(){$(this).remove(),$(".window .comment_wrap").show()}),$(document).on("click","#fancybox-right.photos",function(){$(".album-items-wrap li.curr-"+$(this).data("next")).trigger("click")}),$(document).on("click","#fancybox-left.photos",function(){$(".album-items-wrap li.curr-"+$(this).data("prev")).trigger("click")}),this.viewPhoto(),this.viewCommentImageAttachment(),$(document).on("click",".share-links a:not(.mail-average-icon)",function(){e.ShareLinks(this)}),$(document).on("click",".share-links a.mail-average-icon",function(){e.getShareByMailForm($(this))});var t=$("#catalogsortable select[name=sort], #catalogsortable select[name=categoryId]").each(function(){var e=$(this);e.attr("data-current-val",e.val())});$(document).on("widget_set_content",function(e,t){t==Nethouse.WIDGETS.TYPE_PRODUCTS&&$("#catalogsortable select[name=sort], #catalogsortable select[name=categoryId]").each(function(){var e=$(this);e.attr("data-current-val",e.val())})});var i=$(".catalog-filter-group select#productGroupSelector, .selectorGroup select#productGroupSelector");$(document).on("change",i.selector,function(e){var t=$(e.target),i=t.parents("form"),n=i.find("input[name=productGroup]"),o=i.find("input[name=productCustomGroup]"),a=t.find("option:selected"),r=a.attr("data-group-id"),s=a.attr("data-group-entity-id");r==n.val()&&s==o.val()||(n.val(r),o.val(s),i.submit())}),$(document).on("change",t.selector,function(e){var t=$(e.target);t.data("current-val")!=t.val()&&t.parents("form").submit()}),$(document).on("change","#catalogsortable input[type=checkbox]",function(e){$(this).parents("form").submit()}),view.setPhoneValidator()},showVideo:function(e){var t=this;$.post(e.attr("data-video-href"),function(i){if(!i.success)return void ntNotification.showError("Произошла ошибка. Видео не найдено.");t.changeLocationHash(e.attr("href")),Nethouse.Modal.openHtml(i.block,{open:function(){var e=$(".js-video-window"),n=e.find(".item-content").attr("id").replace("item","");i.nocomment||$.post("/get/commentswindow",{object:n,type:Comments.types.video},function(i){if(i.success){var n,o=$(i.block),a=e.find(".item-info");o.hide(),a.append(o),a.find(".comments-block").slideDown(),t.bindInputCharCounter(),n=e.find("#comment_form"),Comments.initFormImages(n),Comments.initImageUpload(n),Comments.validateWindowForm(n),"undefined"!=typeof CommentsUser&&CommentsUser.reloadEvents()}else ntNotification.showError("Произошла ошибка. Видео не найдено.")},"json")}})},"json")},getShareByMailForm:function(e){var t=this,i={id:e.attr("data-id"),type:e.attr("data-type"),token:e.attr("data-token")};$.post("/getmailform",i,function(e){e.success&&Nethouse.Modal.openHtml(e.form,{open:function(){t.shareByMailFormValidate()}},!1)})},shareByMailFormValidate:function(){$("form#sharebyemail").validate({submitHandler:function(e){return Notifier.showIndicator("sharebyemail"),$(e).ajaxSubmit({success:function(t){if(Notifier.hideIndicator("sharebyemail"),t.success)return void Nethouse.Modal.openHtml(t.success_window,null,!1);void 0!=t.error?Nethouse.Modal.openHtml(t.error,null,!1):t.error!=e&&Nethouse.Modal.openHtml(t.form,null,!1)}}),!1},focusInvalid:!1,focusCleanup:!0,rules:{email:{required:!0,email:!0}},messages:{email:{required:view.translate("Пожалуйста, укажите email адрес"),email:view.translate("Введите корректный email")}},errorPlacement:function(e,t){var i=t.parent().parent().find(".state_field");e.appendTo(i)},highlight:function(e){$(e).attr("id");$(e).parent().parent().find(".state_field").addClass("red"),$(e).addClass("error")},unhighlight:function(e){$(e).parent().parent().find(".state_field").removeClass("red"),$(e).removeClass("error")}})},ShareLinks:function(e){var t=$(e).attr("href"),i=[560,472],n=screen.width?(screen.width-i[0])/2:0,o=screen.height?(screen.height-i[1])/2:0,a="height="+i[1]+",width="+i[0]+",top="+o+",left="+n+",scrollbars=yes,resizable";return window.open(t,"SocialNet",a),!1},
getVideo:function(e){var t=this,i=$(e).prop("class").replace("video-intext ",""),n=$(e).prop("alt").replace(/<(\/)?(\s)*script(\s)*>/,""),o=$(e).prop("id").replace(/<(\/)?(\s)*script(\s)*>/,""),a=$(e).prop("title").replace(/<(\/)?(\s)*script(\s)*>/,""),r=t.VideoConfig[i].content.replace(/\#/g,o);r='<div id="video-content" class="video" style="width: 740px;" data-code="'+o+'"><div class="item-content"><header><h1 class="video__header">'+a+'</h1></header><div class="video__content">'+r+'<div class="video__stub"><div class="video-desc video__desc">'+n+"</div></div></div></div></div>",Nethouse.Modal.openHtml(r,{beforeOpen:function(){$(".fancybox-skin").addClass("imageGallery")},open:function(){t.changeLocationHash("#video-c_"+o)}})},VideoConfig:{youtube:{image:"//img.youtube.com/vi/?/default.jpg",regexp:/(?:(?:youtube\.com\/watch\?(?:[\w\d]+\=[\w\d]+\&)*v\=)|(?:youtu\.be\/)|(?:youtube\.com\/user\/[\w\d]+(?:\?(?:[\w\d]+\=[\w\d]+[\&]?)+)?#p\/(?:[\w]\/){0,4}[\d]+\/))([_a-zA-Z0-9-]+)/i,content:'<iframe width="700" height="390" src="//www.youtube.com/embed/#?rel=0" frameborder="0" allowfullscreen></iframe>'},youtu:{image:"//img.youtube.com/vi/?/default.jpg",regexp:/(?:(?:youtube\.com\/watch\?(?:[\w\d]+\=[\w\d]+\&)*v\=)|(?:youtu\.be\/)|(?:youtube\.com\/user\/[\w\d]+(?:\?(?:[\w\d]+\=[\w\d]+[\&]?)+)?#p\/(?:[\w]\/){0,4}[\d]+\/))([_a-zA-Z0-9-]+)/i,content:'<iframe width="700" height="390" src="//www.youtube.com/embed/#?rel=0" frameborder="0" allowfullscreen></iframe>'},rutube:{image:"//tub.rutube.ru/thumbs-wide/?-2.jpg",regexp:/(?:(?:rutube\.ru\/tracks\/[0-9]+\.html\?v\=)|(?:video\.rutube\.ru\/))([_a-zA-Z0-9]+)/i,content:'<iframe width="700" height="390" src="//rutube.ru/video/embed/#" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowfullscreen></iframe>'},vimeo:{image:"",regexp:/vimeo\.com\/([0-9]+)/i,content:'<iframe src="//player.vimeo.com/video/#?title=0&amp;byline=0&amp;portrait=0" width="700" height="390" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'}},showUpLink:function(e){var t=document.body.clientWidth,i=$("#up-link");t>1100&&$(e).scrollTop()>400?i.fadeIn():i.fadeOut(200)},scrollTop:function(e){return $("body,html").animate({scrollTop:0},200),e.preventDefault(),!1},keyEvents:function(e){if(e=e||window.event,27==e.keyCode){$(".on-edit:not(.static)").not("#comment-edit").length>0&&Site.toggleBlock(),$.jPicker&&$.jPicker.List.forEach(function(e){e.hide()})}},makeOrder:function(e){$forOrder=$(e).parents(".content-block").attr("id").replace("-show","");var t=$(e).parents(".item-content"),i="";return t.length>0&&(i=$(t).attr("id").replace("item","")||""),Feedback.init($forOrder,{sid:i,order:!0})},_initValidate:function(){$.validator.setDefaults({showErrors:function(e,t){if(t.length<1)return void $("ul.errors").remove();$.each(t,function(e,t){var i=$(t.element);i.removeClass("valid").addClass("error"),i.is('input[type="checkbox"]')||(i.removeClass("valid").addClass("error"),i.next("ul.errors").remove(),i.after($("<ul/>").addClass("errors").append($("<li/>").text(t.message))))})}})},preloadBannerImages:function(e){if(void 0!==document.body)try{$("#banner-carousel").html(Notifier.getLoader());var t=document.createElement("div"),i=t.style;i.position="absolute",i.top=i.left=0,i.display="none",document.body.appendChild(t);for(var n in e){var o=document.createElement("img");o.src=e[n],t.appendChild(o)}BannerShow()}catch(e){}},ymaploaded:function(e){var t=$(e).attr("src");void 0!=t&&"about:blank"!=t&&$("#ymap-container #ajax-loader").remove()},findAddress:function(e){var t=$(e),i=t.prevAll(".address-value"),n=(i.html(),i.data("geolat"),i.data("geolng"),i.data("geozoom"));n=n||0;t.hasClass("gmap")||t.hasClass("2gismap");var o=(t.data("host"),t.data("lang"),t.attr("href"));Popup.showDialog('<div id="map-container"><div id="ajax-loader"></div><iframe id="map-frame" width="600" height="450" marginheight="0" marginwidth="0" frameborder="0" src=""></iframe></div>',{closeBtn:!0,padding:10});var a=$("#map-frame");a.attr("src",o),a.load(function(){var e=$(this).attr("src");void 0!=e&&"about:blank"!=e&&$("#map-container #ajax-loader").remove()})},setSrcToFrameMap:function(){var e=$("#main-contacts .address ul iframe[id^=ymap-], #main-contacts .address ul iframe[id^=gmap-], #main-contacts .address ul iframe[id^='2gismap-']");return e.length&&e.each(function(){var e=$(this);if(void 0!=e.attr("src"))return!0;var t=e.attr("id"),i=t.replace(/-\d+/,"");"ymap"!=i&&"gmap"!=i&&"2gismap"!=i&&(i="ymap");var n=$(this).data("host"),o=$(this).data("lang"),a=$(this).prevAll("span.address-value").data("geolat"),r=$(this).prevAll("span.address-value").data("geolng"),s=$(this).prevAll("span.address-value").data("geozoom");s=s||0;var d=$(this).prevAll("span.address-value").html(),c=document.location.protocol+"//"+n+"/"+i+"/addr/"+d+"/"+s+"/w/550/h/300/embedded/"+o;void 0!=a&&void 0!=r&&(c=document.location.protocol+"//"+n+"/"+i+"/coords/"+a+";"+r+"/"+s+"/w/550/h/300/embedded/"+o),$(this).attr("src",c)}),!1},getUrgentMessage:function(){var e={pid:$(".top-news").data("mid")},t=function(e){Popup.showDialog(e.content)};return view.query("/geturgentcontent",t,null,e),!1},setPostCounterNull:function(){var e=$("#blog-counter");if(e.length>0){var t={type:"all"},i=function(){e.hide()};view.query("/markpostread",i,null,t)}},toggleLanguage:function(e){var t=$(e).val()||"ru";return view.query("/togglelang",function(e){void 0!=e.success&&1==e.success&&window.location.reload()},"",{lang:t}),!1},bindImageViewer:function(e,t){var i=this;if(e&&e.length){var n=function(){};t=t||{},t.fitToView=!1,t.fixed=!1,t.scrolling=t.scrolling||"no",t.nextEffect="none",t.prevEffect="none",t.openEffect="fade",t.openSpeed="slow",t.iframe={preload:!1},t.minHeight=1,t.live=!0,t.minWidth=1,t.beforeShow&&(n=t.beforeShow);t.afterLoad&&t.afterLoad;var o=function(){};t.beforeLoad&&(o=t.beforeLoad);var a=function(){};t.afterClose&&(a=t.afterClose),t.beforeLoad=function(){return i.fancy=this,$.fancybox.showLoading(),o()},t.beforeShow=function(){"html"==i.fancy.type&&void 0==i.fancy.isGallery&&(i.fancy.height=$(".fancybox-inner").innerHeight()),$("html").addClass("modal-open"),$.fancybox.hideLoading();var e=$(".fancybox-wrap");e.addClass(t.className),e.addClass("imageviwer"),t.clickBlocked||e.addClass("can-close");var o=t.href||i.fancy.href;if(o){var a;if(/\/img\//.test(o)){var r=i.fancy.element.context.id.split("-");r[1]&&i.changeLocationHash("#img-"+r[1])}else/http[s]?:\/\/.*\/video/.test(o)&&(a=o.replace(/http[s]?:\/\/.*\/video\//,""))&&i.changeLocationHash("#video-"+a)}else{var s=this.content,d=$(s).closest("#video-content").data("code");d&&i.changeLocationHash("#video-c_"+d)}n(),i.isFancyLoad=!0},t.afterClose=function(e){if($("html").removeClass("modal-open"),window.location.hash.length>1)if(window.history&&window.history.replaceState){var t=window.location.pathname+window.location.search;window.history.replaceState({},"",t)}else window.location.hash=" ";a(e),i.isFancyLoad=!1},e.fancybox(t)}},scrollbarWidth:function(){var e,t=$("body"),i=$('<div style="position: absolute; left: -100000px; height: 100px; width: 100px;"></div>');return t.append(i),e=i.width(),i.css("overflow","scroll"),e-=i.width(),e||(e=i.width()-i[0].clientWidth),i.remove(),$("head").append('<style type="text/css">.modal-open { padding-right: '+e+"px } .scroll-width { padding-right:"+e+"px }</style>"),e},checkViewer:function(){var e=window.location.hash;if(/^#img-.*$/.test(e)){var t=e.split("-");if(null===t)return;t=t[1],$("#view-"+t).trigger("click");var i=new RegExp("^.*"+t+".*$");$("a.fancy-img, img.fancy-img-post, li.view-photo a").each(function(){$this=$(this);var e="";if($this.is("a")?e=$this.attr("href"):$this.is("img")&&(e=$(this).data("eval")),i.test(e))return $this.trigger("click"),!1})}else if(/^#video-\d*$/.test(e)){var n=e.match(/^#video-(\d+)$/);if(null===n)return;n=n[1];var i=new RegExp("^.*#video-"+n+".*$");$("a.video-link,.video-item a:not(.video-link)").each(function(){var e=$(this).attr("href");if(i.test(e))return $(this).trigger("click"),!1})}else if(/^#video-c_\w+$/.test(e)){var o=e.match(/^#video-c_(\w+)$/);if(null===o)return;o=o[1],$("#"+o).trigger("click")}},changeLocationHash:function(e){window.history&&window.history.replaceState?window.history.replaceState({},"",e):window.location.hash=e},getPhotos:function(e,t){return $.ajax("/photoalbum/load/getalbumphotos",{method:"POST",data:{aid:e,page:t,isView:!0},dataType:"json"}).then(function(e){if(e.success){var t=$(e.data).wrap("<div></div>").parent();return this.preparePhotosData(t.find(".photos a"),t.find("#photoview-tpl").data("base"))}}.bind(this))},preparePhotosData:function(e,t){return e.map(function(){var e=$(this).parent(),i=e.parents(".album-items-wrap"),n=i.hasClass("homepage"),o=e.data(),a=i.data();return o.fullSize_href=o.raw,o.id=e.attr("id"),o.src=o.view,o["photoId_data-pid"]=o.pid,o["desctext_data-pid"]=o.pid,n&&(a=$.extend(a,e.find(".view-photo-href").data())),o=$.extend({},o,a),o.albumname_href=t+"/"+o.albumid,o}).get()},viewPhoto:function(){var e,t,i,n,o=this,a=$("#photoview-tpl"),r=$("#photoalbum-show .view-photo > a");return r.on("click",function(){return e=o.preparePhotosData(r,a.data("base")),t=!0,Nethouse.Modal.openListImages(e,a.html(),r.index(this),{open:function(e){i=function(t,i){var n=window._.find(e.items,function(e){return(e.data?e.data.pid:e.pid)==i.pid});n.data.desc=i.desc,n.data.desctext=i.desctext,Nethouse.Modal.update()},n=function(){Nethouse.Modal.close()},$(document).on("changePhotoDesc",i),$(document).on("deletePhoto",n)},beforeNext:function(){return t},beforePrev:function(){return t},close:function(){$(document).off("changePhotoDesc",i),$(document).off("deletePhoto",n)},change:function(e,i){var n=e.data.page,a=Math.ceil(e.data.total/40),r=null,s=e.data.albumid;return t=!1,s?(e.data.current==40*n||e.data.current==e.data.total?r=a==n?1:n+1:e.data.current==40*(n-1)+1&&(r=1==n?a:n-1),!r||_.findWhere(i.st.items,{page:r})?void(t=!0):void o.getPhotos(e.data.albumid,r).then(function(e){r<n&&(i.st.index=i.index+e.length,i.index=i.index+e.length),i.st.items=i.st.items.concat(e),i.st.items=_.sortBy(i.st.items,"current"),i.items=_.clone(i.st.items),i.updateItemHTML(),t=!0})):void(t=!0)},imageLoaded:function(e){var t=$(".js-photo-window"),i=t.find("#view-photo-desc"),n=t.find("#photo-desc"),a=""!=$.trim(i.find(".text").text()),r=e.data.id.split("-");n.val(n.html()),i.find(".placeDesc").toggle(!a),r[1]&&o.changeLocationHash("#img-"+r[1]),void 0!=o.getcomments&&o.getcomments.abort(),o.getcomments=$.post("/get/commentswindow",{object:e.data.pid,type:Comments.types.images},function(e){if(e.success){var i,n=$(e.block);t.find(".js-photo-window__comments").html(n),o.bindInputCharCounter(),i=t.find("#comment_form"),Comments.initFormImages(i),Comments.initImageUpload(i),Comments.validateWindowForm(i),"undefined"!=typeof CommentsUser&&CommentsUser.reloadEvents()}}.bind(this),"json")}.bind(this)}),!1}),!1},viewCommentImageAttachment:function(){return $("body").on("click",".js-comment-image-link",function(){var e=$(this).parents(".js-comment-images").find(".js-comment-image-link"),t=e.map(function(){var e=$(this),t=e.data();return t.src=t.view,t.fullSize_href=t.raw,t}).get();return Nethouse.Modal.openListImages(t,$(".js-imageAttachmentView-tpl").html(),e.index(this)),!1}),!1},charCounter:function(e,t,i,n){void 0!==n&&!1===n&&(e=e.replace(/(<\/?[^>]+>)|(&nbsp;)/gi,""));var o=t-e.length;o<0&&(o=0),i.html(o)},bindInputCharCounter:function(){var e=this,t='<span class="infoDigits char_info">'+view.translate("Осталось символов")+': <span class="char_limit"></span></span>';$("input, textarea:visible, #comment_form textarea").each(function(){var i,n=$(this),o=n.data("charcounter");if(i=n.attr("maxlength")){var a,r;if(n.parents("dd").length&&"no"!=o){r=n.attr("id");var s=n.parents("dl").find("dt#"+r+"-label");s.find("span.char_info").length||s.prepend(t),a=$("#"+r+"-label .char_info .char_limit")}else"yes"==o&&(r=n.attr("id"),n.parent().find("span.char_info").length||n.parent().prepend(t),a=n.parent().find("span.char_info .char_limit"));void 0!==r&&$("#"+r).unbind(".limit").bind("change.limit keyup.limit",function(){e.charCounter($(this).val(),i,a)}).triggerHandler("change.limit")}})},bindInputCharCounterByElement:function(e){var t,i=this,n='<span class="infoDigits char_info">'+view.translate("Осталось символов")+': <span class="char_limit"></span></span>',o=e.data("charcounter");if(t=e.attr("maxlength")){var a,r;if(e.parents("dd").length&&"no"!=o){r=e.attr("id");var s=e.parents("dl").find("dt#"+r+"-label");s.find("span.char_info").length||s.prepend(n),a=$("#"+r+"-label .char_info .char_limit")}else"yes"==o&&(r=e.attr("id"),e.parent().find("span.char_info").length||e.parent().prepend(n),a=e.parent().find("span.char_info .char_limit"));void 0!==r&&$("#"+r).unbind(".limit").bind("change.limit keyup.limit",function(){i.charCounter($(this).val(),t,a)}).triggerHandler("change.limit")}},subscriberAddFormValidate:function(){$('form#subscriber-add-form input[type="text"]:visible:not([placeholder])').focus(function(){var e=$(this);e.val()==e.data("default")&&e.val("")}).blur(function(){var e=$(this),t=e.val(),i=e.data("default");""==t&&e.val(i)}),$("form#subscriber-add-form").validate({submitHandler:function(e){return Notifier.showIndicator("subscribe-left"),$(e).ajaxSubmit({success:function(e){Notifier.hideIndicator("subscribe-left");try{if(void 0!=e.form){var t=$(e.form).find('input[id*="csrf"]');t.length&&$("#subscriber-add-form").find('input[id*="csrf"]').replaceWith(t)}void 0!=e.success&&1==e.success?Nethouse.Modal.openHtml(e.success_window,null,!1):ntNotification.showError("Ошибка при добавлении подписчика")}catch(e){ntNotification.showError(e.message)}}}),!1},focusInvalid:!0,focusCleanup:!1,errorClass:"error",rules:{name:{required:!0,minlength:1},email:{required:!0,email:!0}},messages:{name:{required:view.translate("Пожалуйста, укажите свое имя")},email:{required:view.translate("Пожалуйста, укажите email адрес"),email:view.translate("Введите корректный email")}}})},formsHashHandler:function(){var e,t=location.hash;void 0!==t&&""!==t&&null!==t&&(e=function(){switch(!0){case/\#(\/)?feedback/.test(t):return"a.feedback-btn[data-type=0]";case/\#(\/)?callback$/.test(t):return"a.feedback-btn[data-type=1]";case/\#(\/)?order\-form/.test(t):return"button.order, .buttons.order";case/\#(\/)?one\-click\-form/.test(t):return"a.one-click-order-btn";default:return""}}.call(this),null!==$(e)&&$(e).length>0&&$(e).trigger("click"))},initDropDown:function(){$(".ui.dropdown").on("click",function(e){e.stopPropagation()}),$(".ui.dropdown:not(.with-inputs)").each(function(e,t){t=$(t),t.find("label.item").removeClass("active");var i=t.children(".text").addClass("default");i.attr("data-text")||i.attr("data-text",i.text()),t.dropdown({useLabels:!1,message:{count:i.attr("data-text")+" ({count})"}})}),$(".ui.dropdown.with-inputs").dropdown({useLabels:!1,action:"nothing"}),$(".ui.dropdown.menu").dropdown({action:"nothing",transition:"fade",keepOnScreen:!0})},initTab:function(){$("#product-full-desc .paths .menu .item").on("click",function(e){e.stopPropagation()}),$("#product-full-desc .paths .menu .item").tab({context:"#product-full-desc .paths"})}};var d=document,ie=d.all&&!window.opera,op="",OneClickBuy={selector:"a.one-click-order-btn",formSelector:"form.order-by-click",link:void 0,init:function(){$(this.selector).length>0&&this.initEventListener()},initEventListener:function(){var e=this;$(document).on("click",this.selector,function(t){setTimeout(function(){e.openModal($(e.selector),t)},200)})},handleFormSubmit:function(){var e=$(this.formSelector).parents(".window").find("button.send"),t=this;e.length>0&&$(e).click(function(e){e.preventDefault(),$(t.formSelector).submit()})},openModal:function(e,t){var i=$(e).attr("data-product-id"),n=$(e).attr("data-href"),o=this,a=$("#product-params-view").length>0?$("#product-params-view"):$("#product-params-view-responsive"),r=[];if(a.length>0&&(r=window.Nethouse.cart.getParamsValues(a),!r.length))return ntNotification.showWarning("Выберите все параметры",4e3),void t.preventDefault();Nethouse.Modal.openHtmlAjax(n,{opts:{type:"POST",data:{productId:i,selectedParams:JSON.stringify(r)}},error:"Ошибка при загрузке формы",open:function(){o.addFieldsValidators(),o.handleFormSubmit()}})},addFieldsValidators:function(){$(this.formSelector).validate({focusInvalid:!1,focusCleanup:!0,rules:{clientName:{required:!0},clientPhone:{required:!0,phone:!0}},messages:{clientName:{required:view.translate("Введите корректное имя")},clientPhone:{required:view.translate("Введите номер телефона")}}})}};Feedback={init:function(e,t){return __awaiter(this,void 0,void 0,function(){var i,n;return __generator(this,function(o){switch(o.label){case 0:return this.type=e,(this.params=t||{},this.loadEvents(),"products"!==e)?[3,2]:(i=this,[4,$.get("/form-fields/2")]);case 1:return i.formOrderSettings=o.sent(),this.id="products-edit-window",[3,5];case 2:return"feedback"!==e?[3,3]:(this.id="feedback-edit-window",[3,5]);case 3:return n=this,[4,$.get("/form-fields/6")];case 4:n.formServiceSettings=o.sent(),this.id="services-edit-window",o.label=5;case 5:return this.showFeedback(),[2,!1]}})})},loadEvents:function(){},showFeedback:function(){var e,t=this;if(this.params.order)e="/"+this.type+"/load/makeorder",this.params.type=this.type,i=this.params;else{e="/mailer/getform";var i={type:this.type}}return Nethouse.Modal.openHtmlAjax(e,{opts:{type:"POST",data:i},error:"Ошибка при загрузке формы",open:function(){$(t.windowId).addClass(t.type),t.submitFeedback($("#"+t.type+"-order-form"))}}),!1},submitFeedback:function(e){var t=this,i=$(e);return e.validate({submitHandler:function(e){var i=t.type+"-edit-window";Notifier.showIndicator(i,!0),$(e).ajaxSubmit({dataType:"json",success:function(e){Notifier.hideIndicator(i,!0);try{if(void 0!=e&&1==e.success){if(e.script_url){var n=document.createElement("script");n.async=!0,n.src=e.script_url,document.body.appendChild(n)}Nethouse.Modal.close(),setTimeout(function(){ntNotification.showSuccess(view.translate("Форма успешно отправлена"));var e=Nethouse.DynamicForm.getSubmitHash(t.type);e&&(window.location.hash=e)},300)}else{var o=e.msg||view.translate("Ошибка при отправке письма!");Notifier.showError(o,"#"+t.id+" #windowContent")}}catch(e){ntNotification.showError(e)}}})},focusInvalid:!1,focusCleanup:!0,rules:t.feedbackRules(e),messages:t.feedbackErrors(e)}),(i.is("#product-order-form")||i.is("#products-order-form")||i.is("#services-order-form"))&&t.initUploadFile(e),!0},initUploadFile:function(e){var t,i,n=this,o=["doc","docx","xls","xlsx","pdf","jpg","jpeg","gif","png","zip","rar"],a=$(e),r=!1,s=$('<div id="progress"><div class="progressbar-value"></div></div>'),d="fancybox-content",c=a.attr("data-file-upload")||"/putdocpub";a.is("#product-order-form")||a.is("#products-order-form")?d="products-edit-window":a.is("#services-order-form")&&(d="services-edit-window"),t=a.find(".attach-btn span"),i=new Nethouse.Uploader(t[0],{path:c}),i.addExtensionFilter(o).addFileSizeFilter(20*Nethouse.Uploader.MB).on("before",function(e){e.length&&(Notifier.showIndicator(d),s.hide(),r||(r=!0,t.after(s)),t.hide())}.bind(this)).on("progress",function(e){s.show(),s.find(".progressbar-value").css({width:e.loaded/e.total*100+"%"})}).on("filecomplete",function(e,i,o){if(Notifier.hideIndicator(d),s.hide(),t.show(),e)return void ntNotification.showError(sprintf(window.view.translate("js_uploader_upload_file_fail"),o.name),6e3);var r,c,l,u,p,m,h,f=window.JSON.parse(i.response);f.success&&f.url||ntNotification.showError(sprintf(window.view.translate("js_uploader_upload_file_fail"),o.name),6e3),r=f.url,c=f.name,l=f.size,u=f.timestamp,a.find("#attach-url").val(r),a.find("#attach-name").val(c),a.find("#attach-size").val(l),a.find("#attach-timestamp").val(u),p=a.find(".attach-info .file-info"),p.find(".attach-file-name").html(c),m=n.getHumanReadableFileSize(l),p.find(".attach-file-size").html(m),p.parent().show(),a.find(".attach-btn").hide(),(h=n.getFileIcon(c))&&a.find(".file-icons").addClass(h)}).on("error",function(e,i){s.hide(),t.show();var n=Nethouse.Uploader.Errors;switch(e){case n.EXTENSION:ntNotification.showError(sprintf(view.translate("js_uploader_extension_fail"),i.file.name,o.join(", ")),6e3);break;case n.MAX_SIZE:ntNotification.showError(sprintf(view.translate("js_uploader_max_size_fail"),i.file.name,"20 MB"),6e3)}}.bind(this))},getHumanReadableFileSize:function(e){e=parseInt(e);return e>=1048576?Math.round(e/1048576*10)/10+" Мб":e>=1024?Math.round(e/1024*10)/10+" кб":e+" б"},getFileIcon:function(e){e=e.toLowerCase();var t={pdf:[/pdf$/],xls:[/xls$/,/xlsx$/],jpg:[/jpg$/,/jpeg$/],psd:[/psd$/],mp3:[/mp3$/],gif:[/gif$/],ai:[/ai$/],eps:[/eps$/],png:[/png$/],zip:[/zip$/],rar:[/rar$/],txt:[/txt$/],rtf:[/rtf$/],doc:[/doc$/,/docx$/],ppt:[/ppt$/,/pptx$/],djvu:[/djvu$/,/djvue$/],fb:[/fb$/],ps:[/ps$/]},i=null;for(var n in t){var o=t[n];for(var a in o)if(o[a].test(e)){i=n;break}}return i&&(i+="-icon"),i},getUid:function(e){e=e||32;for(var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],i="",n=0;n<e;n++){i+=t[Math.floor(16*Math.random())+0]}return i},startProgressUpload:function(e,t){var i=this,n=$('<div id="progress"><div class="progressbar-value"></div></div>');$(e).after(n).css("display","none"),setTimeout(function(){i.updateProgress(t,n)},1e3)},updateProgress:function(id,progressbar,success){var _self=this;$.ajax({url:"/getprogress",timeout:3e3,headers:{"X-Progress-ID":id},dataType:"script",complete:function(e,t){},error:function(e,t,i){},success:function(data){var response=null;try{response=eval(data)}catch(e){response={}}var progress=0;if(void 0!=response.state)if(void 0!=success&&"function"==typeof success)success(response,id);else{if("uploading"==response.state){var size=response.size,received=response.received;progress=Math.floor(received/size*100),size!=received&&setTimeout(function(){_self.updateProgress(id,progressbar)},1e3)}else{if("starting"==response.state)return void setTimeout(function(){_self.updateProgress(id,progressbar)},500);"done"==response.state&&(progress=100)}progressbar.find(".progressbar-value").stop(!0).animate({width:parseInt(3*progress)+"px"},2e3)}}})},feedbackRules:function(e){var t=$(e).data("type"),i={FORM_TYPE_FEEDBACK:0,FORM_TYPE_CALLBACK:1,FORM_TYPE_ORDER:2,FORM_TYPE_PRODUCT_IN_STOCK:7},n={maxlength:1e3};"call"!=t&&(n.required=!0);var o={content:n,fio:{required:!0,maxlength:100},email:{required:!0,maxlength:50,email:!0},phone:{phone:!0,required:!0,maxlength:26}};switch(t){case"services":if(this.formServiceSettings)for(var a in this.formServiceSettings.fields)"allow_upload"!==a?a in o?o[a].required=this.formServiceSettings.fields[a].required:this.formServiceSettings.fields[a].required&&(o[a]={required:this.formServiceSettings.fields[a].required}):o.files={required:this.formServiceSettings.fields[a].required};o.serviceName={required:!0},o.content={required:!1};break;case"products":if(o.productName={required:!0},o.phone={phone:!0},this.formOrderSettings)for(var a in this.formOrderSettings.fields)"allow_upload"!==a?a in o?o[a].required=this.formOrderSettings.fields[a].required:this.formOrderSettings.fields[a].required&&(o[a]={required:this.formOrderSettings.fields[a].required}):o.files={required:this.formOrderSettings.fields[a].required};break;case i.FORM_TYPE_FEEDBACK:o.phone={required:!1}}return o},feedbackErrors:function(){var e={content:{maxlength:view.translate("Введено больше символов"),required:view.translate("Обязательное поле")},fio:{maxlength:view.translate("Введено больше символов"),required:view.translate("Обязательное поле")},email:{maxlength:view.translate("Введено больше символов"),required:view.translate("Обязательное поле"),email:view.translate("Неверный формат почты")},phone:{phone:view.translate("Только цифры и +. Пример: +79123456789"),maxlength:view.translate("Введено больше символов"),required:view.translate("Обязательное поле")}};switch(this.type){case"services":if(this.formServiceSettings)for(var t in this.formServiceSettings.fields)"allow_upload"!==t?t in e?e[t].required=view.translate("Обязательное поле"):this.formServiceSettings.fields[t].required&&(e[t]={required:view.translate("Обязательное поле")}):e.files={required:view.translate("Обязательное поле")};e.serviceName={required:view.translate("Выберите услугу")};break;case"products":if(e.productName={required:view.translate("Выберите товар")},this.formOrderSettings)for(var t in this.formOrderSettings.fields)"allow_upload"!==t?t in e?e[t].required=view.translate("Обязательное поле"):this.formOrderSettings.fields[t].required&&(e[t]={required:view.translate("Обязательное поле")}):e.files={required:view.translate("Обязательное поле")}}return e}},$(document).ready(function(){Visitor.init()});var PromoCodeService=function(){function e(){}return e.getDiscountPromoCode=function(e){return $.ajax({type:"POST",url:"/products/load/getdiscount",data:{code:e},dataType:"json"}).then(function(e){return e})},e}(),Cart=function(){this.blockId="products",this.blockLeft="products-cart-left",this.orderBtn=$("#products").find(".buttons.cart"),this.bellBtn=$("#products").find(".buttons.bell"),this.payInPartsInfo=$("#products").find(".product__pay-in-parts-question-mark"),this.orderForm="#product-order-form",this.pushUrl="/"+this.blockId+"/load/pushtocart",this.updateUrl="/"+this.blockId+"/load/updatecart",this.promocode=null,this.totalSumm=0,this.totalSummWithDelivery=0,this.timeouts={},this.orderData=$("#view-cart-show"),this.clientData=$("#user-info"),this.initIncremental(),this.loadEvents(),this.addValidateMethods(),this.initShipping(),this.initPromoCode()};$.extend(Cart.prototype,{initIncremental:function(){$(".js-incremental-field").incrementalInput({min:0,canChange:function(e){return!Cart.countUpdated&&!e.prop("disabled")},onChange:function(e,t,i){0===t&&0==i||this.restoreItem(e)||this.update(e,"update",!0)}.bind(this)})},addValidateMethods:function(){$.validator.addMethod("payment_qiwi_phone",function(e,t){return!$("#payments-14").attr("checked")||(e=e.replace(/[^\d]/g,""),this.optional(t)||/^(7|8)\d{10}$/i.test(e))},view.translate("Введите корректный номер QIWI кошелька")),$.validator.addMethod("phone",function(e,t){var i=e.trim();return this.optional(t)||/^[+]?(\d)+$/i.test(i)},view.translate("Только цифры и +. Пример: +79123456789")),$.validator.addMethod("payment_pscb_phone",function(e,t){return!$("#payments-204").attr("checked")||(e=e.replace(/[^\d]/g,""),this.optional(t)||/^(7|8)\d{10}$/i.test(e))},view.translate("Введите корректный номер ПСКБ кошелька")),$.validator.addMethod("payer_inn",function(e,t){return!$("#payments-2").prop("checked")||(e=e.replace(/[^\d]/g,""),this.optional(t)||/^([0-9]{10}|[0-9]{12})$/i.test(e))},view.translate("Введите корректный ИНН")),$.validator.addMethod("payer_kpp",function(e,t){return!$("#payments-2").prop("checked")||(e=e.replace(/[^\d]/g,""),this.optional(t)||/^([0-9]{9})?$/i.test(e))},view.translate("Введите корректный КПП")),$.validator.addMethod("onecheck",function(){return $("#accept_agreement:checked").length>=1},"Принять условия публичной оферты")},summDeliveryPrice:function(e){var t=$("#delivery-choose");if(t.length>0){var i=t.find("input.delivery-choose:checked").val();if(void 0!=i&&e>0){var n=parseFloat(i.replace("/[^d.]/",""));t.find("#total-summ-order span").html((e+n).toFixed(2))}else t.find("#total-summ-order span").html(e.toFixed(2))}},initPromoCode:function(){var e=this,t=$("#promocode-form");t.find("input").val()&&this.checkPromoCode(),$(document).on("click",t.find(".buttons").selector,function(){return e.checkPromoCode(),!1}),$(document).on("input",t.find("input").selector,delay(function(e){return this.checkPromoCode(),!1}.bind(this),500))},initShipping:function(){var e=$.fn.shipping.events,t=$(document),i=this.orderData.find(".btn-contact-step"),n=$(".js-shipping").shipping();n.length&&(i.on("click",function(){return n.shipping("citySelected")&&n.shipping("rateSelected")}),n.on(e.rateChanged,function(e,t){var i=this.getTotal(),n=(i+t.price).toFixed(2),o=this.getTotalShippingElm();$(".js-shipping__shipment-id").val(t.shipment),$(".js-shipping__rate-id").val(t.id),$(".js-shipping__pickup-point-id").val(t.pickupPoint),o.html(n).data("shipping-price",t.price)}.bind(this)),t.on("cart-total-changed",function(){var e,t=this.getTotal(),i=this.getTotalShippingElm();if(this.summDeliveryPrice(t),!i.length)return!0;e=(t+i.data("shipping-price")).toFixed(2),i.html(e)}.bind(this)),t.on("cart.update",function(){n.trigger(e.updateRates)}))},getTotalShippingElm:function(){return this.orderData.find(".js-cart__total_with-shipping")},getTotalElm:function(){return this.orderData.find(".js-cart__total")},getTotal:function(){return parseFloat(this.getTotalElm().text())},getTotalWithShipping:function(){return this.totalSummWithDelivery},setTotalWithShipping:function(e){this.totalSummWithDelivery=e||0},setTotal:function(e){this.getTotalElm().html(e)},totalChanged:function(){$(document).trigger("cart-total-changed")},afterCheckGrecapcha:function(e){var t=this;if("undefined"!=typeof grecaptcha)try{grecaptcha.ready(function(){grecaptcha.execute().then(function(i){t.replaceRecaptchaTokenAtForm(i),e()})})}catch(t){console.log("error work with google api recapcha",t.toString()),e()}else e()},loadEvents:function(){var e=this,t=$(".payments-step"),i=$("#shipping-info");e.paramsNotSelectedClass="not-selected",e.hasStore=t.length>0;var n=$("#top-body:not(.cabinet)"),o=function(){var t=$(".contacts-step"),i=$(".cart-step"),n=$(".pay-step");$(".shipping-step").removeClass("active"),t.find(".separate").removeClass("arrow_step_fl").addClass("arrow_step_fr"),n.find(".separate").removeClass("arrow_step").addClass("arrow_step_fl"),i.removeClass("active"),t.addClass("active");var o=$("input.delivery-choose:checked");if(o.length){var a=parseInt(o.data("dlvr"));$("#product-order-form").find("#dlvrId").val(a)}e.clientData.show(),$("html,body").animate({scrollTop:$(".order-steps").offset().top-30},100),e.orderData.hide()};$(document).on("change",e.orderData.find(".num-items").selector,function(){return 0==e.orderData.find("tr:not(.deleted-item) .num-items.error").length&&e.orderData.find(".btn-contact-step").removeClass("disable"),e.restoreItem(this)||e.update(this,"update",!0),!1}),$(document).on("click",e.orderData.find(".btn-contact-step:not(.disable)").selector,function(){return Cart.countUpdated?($(document).off("toContactStep"),$(document).on("toContactStep",function(){o()})):o(),!1}),$(".prev-step-contacts, .prev-step").keypress(function(){return!1}),$(document).on("click","#payer_inn_suggest",function(){var e=document.getElementById("payer_inn").value;return!(e.length<9)&&(setTimeout(function(){$("#payer_inn_suggest").html("&#128269;")},5e3),$("#payer_inn_suggest").html("&#8987;"),$.post("/cart/suggest-by-inn",JSON.stringify({data:{inn:e}}),function(e){$("#payer_inn_suggest").html("&#128269;"),$("#payer_kpp").val(e.kpp),$("#payer_name").val(""!=e.name?e.name:e.individual_entrepreneur_name),$("#payer_address").val(e.address)}),!1)}),e.hasStore&&($(document).on("click",e.clientData.find(".btn-payments-step").selector,function(){if($(e.orderForm).valid()){var i=$(".contacts-step"),n=($(".cart-step"),$(".pay-step"));$(".shipping-step").removeClass("active"),i.find(".separate").removeClass("arrow_step_fr").addClass("arrow_step"),n.find(".separate").removeClass("arrow_step_fl").addClass("arrow_step_fr"),i.removeClass("active"),n.addClass("active"),t.show(),$("html,body").animate({scrollTop:$(".order-steps").offset().top-30},100),e.clientData.hide()}return!1}),$(document).on("click",t.find(".prev-step-contacts").selector,function(){var i=$(".contacts-step"),n=($(".cart-step"),$(".pay-step")),o=$(".shipping-step");return $("#confirm-info").hide(),o.removeClass("active"),i.find(".separate").removeClass("arrow_step").addClass("arrow_step_fr"),n.find(".separate").removeClass("arrow_step_fr").addClass("arrow_step_fl"),i.addClass("active"),n.removeClass("active"),t.hide(),
e.clientData.show(),!1})),$(document).on("click",e.clientData.find(".prev-step").selector,function(t){if($("#shipping-info").length>0){var i=$(".contacts-step"),n=$(".shipping-step");return $("#shipping-info").show(),$("#user-info").hide(),i.removeClass("active"),n.addClass("active"),!1}return e.toCartStep(),!1}),$(document).on("click",this.orderBtn.selector,function(){return e.grabParamsAndAdd(this)}),$(document).on("click",this.bellBtn.selector,function(){return window.location.hash="form-information",e.addSubscriber(this,!1)}),$(document).on("click",this.payInPartsInfo.selector,function(){if(Popup){Popup.showDialog("<div style=\"max-width: 470px; padding: 8px 24px;\"><div style=\"margin: 24px 0px 20px !important; font-size: 24px !important; line-height: 28px !important; font-weight: bold !important;\">Можно просто взять кредит</div><div><div style=\"display: inline-block !important; vertical-align: top !important; margin-right: 15px !important; width: 30px !important; height: 30px !important; background: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='34' height='34'%3E%3Cg fill='none' fill-rule='evenodd' transform='translate(2 3)' opacity='.3'%3E%3Cpath fill='%23000' d='M12.536 11.888V6.88h3.52c1.237 0 2.205.259 2.904.776.699.517 1.048 1.32 1.048 2.408 0 .565-.093 1.04-.28 1.424a2.45 2.45 0 0 1-.8.944c-.347.245-.768.421-1.264.528a7.98 7.98 0 0 1-1.672.16h-1.136v1.28H18.2v1.216h-3.344V18h-2.32v-2.384h-1.232V14.4h1.232v-1.28h-1.232v-1.232h1.232zm2.32-3.424v3.424h1.04c.565 0 1.005-.128 1.32-.384.315-.256.472-.704.472-1.344 0-.63-.141-1.07-.424-1.32-.283-.25-.717-.376-1.304-.376h-1.104z'/%3E%3Crect width='28' height='22' x='1' y='1' stroke='%23000' stroke-width='2' rx='3'/%3E%3Cpath fill='%23000' d='M12 24h6v2h-6zM7 26h16v2H7z'/%3E%3C/g%3E%3C/svg%3E&quot;) center center / contain no-repeat !important;\"></div><div style=\"display: inline-block !important; width: calc(100% - 50px) !important; margin-bottom: 20px !important;\"><div style=\"font-size: 15px !important; line-height: 21px !important; font-weight: bold !important; margin-bottom: 4px !important;\">Деньги сейчас: от 3 000 до 150 000 руб.</div><div style=\"font-size: 13px !important; line-height: 17px !important;\">Заполнение анкеты, проверка и выдача кредита — всё прямо на сайте (нужен паспорт РФ). В корзине выберите способ оплаты \"Заплатить по частям\"</div></div></div><div><div style=\"display: inline-block !important; vertical-align: top !important; margin-right: 15px !important; width: 30px !important; height: 30px !important; background: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='34' height='34'%3E%3Cg fill='none' fill-rule='evenodd' transform='translate(3 1)' opacity='.3'%3E%3Cpath fill='%23000' d='M12.755 26H5.72v-1.98c.9-.67 1.662-1.265 2.288-1.785.625-.52 1.127-.995 1.507-1.425.38-.43.655-.835.825-1.215.17-.38.255-.775.255-1.185 0-.5-.147-.892-.443-1.177-.295-.286-.707-.428-1.237-.428-.53 0-1.037.115-1.522.345-.486.23-.943.535-1.373.915v-1.89c.42-.32.877-.577 1.373-.773.495-.195 1.102-.292 1.822-.292.53 0 1.015.072 1.455.218.44.145.817.357 1.133.637.315.28.557.622.727 1.027.17.406.255.863.255 1.373 0 .5-.097.975-.293 1.425-.195.45-.49.905-.885 1.365-.395.46-.897.942-1.507 1.447-.61.506-1.33 1.063-2.16 1.673h4.815V26zm9.775-3.075c0 .49-.095.935-.285 1.335-.19.4-.457.74-.803 1.02-.345.28-.762.495-1.252.645-.49.15-1.035.225-1.635.225-.73 0-1.347-.087-1.852-.262-.506-.176-.918-.378-1.238-.608v-1.815c.16.12.337.24.533.36.195.12.407.227.637.323.23.095.487.174.772.24.286.065.598.097.938.097.69 0 1.2-.147 1.53-.442.33-.296.495-.698.495-1.208 0-1.03-.665-1.545-1.995-1.545H17.1v-1.71h1.35c.48 0 .867-.122 1.163-.367.295-.246.442-.603.442-1.073 0-.43-.145-.765-.435-1.005-.29-.24-.715-.36-1.275-.36-.57 0-1.065.102-1.485.308-.42.205-.805.442-1.155.712V15.98c.33-.25.725-.457 1.185-.623.46-.165 1.06-.247 1.8-.247.53 0 1.01.07 1.44.21.43.14.795.335 1.095.585.3.25.53.552.69.908.16.355.24.742.24 1.162 0 .33-.057.63-.172.9-.116.27-.265.507-.45.712-.186.206-.4.37-.646.495a2.841 2.841 0 0 1-.757.263c.32.05.625.142.915.277.29.136.545.313.765.533.22.22.395.477.525.772.13.296.195.628.195.998zM6 0h2v7H6zM20 0h2v7h-2z'/%3E%3Crect width='26' height='26' x='1' y='4' stroke='%23000' stroke-width='2' rx='3'/%3E%3Cpath fill='%23000' d='M2 9h26v2H2z'/%3E%3C/g%3E%3C/svg%3E&quot;) center center / contain no-repeat !important;\"></div><div style=\"display: inline-block !important; width: calc(100% - 50px) !important; margin-bottom: 20px !important;\"><div style=\"font-size: 15px !important; line-height: 21px !important; font-weight: bold !important; margin-bottom: 4px !important;\">Выплаты потом</div><div style=\"font-size: 13px !important; line-height: 17px !important;\">Через кошелёк в Яндекс.Деньгах — просто пополняйте баланс наличными или с карты</div></div></div><div><div style=\"display: inline-block !important; vertical-align: top !important; margin-right: 15px !important; width: 30px !important; height: 30px !important; background: url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='34' height='34'%3E%3Cpath d='M10.404 28.34c-1.315 0-2.51-.26-3.587-.782-1.077-.521-2-1.298-2.771-2.329-.77-1.031-1.366-2.335-1.785-3.91-.42-1.575-.629-3.417-.629-5.525 0-2.108.215-3.944.646-5.508.43-1.564 1.031-2.862 1.802-3.893.77-1.031 1.694-1.802 2.771-2.312 1.077-.51 2.261-.765 3.553-.765 1.315 0 2.505.255 3.57.765s1.983 1.275 2.754 2.295c.77 1.02 1.366 2.306 1.785 3.859.42 1.553.629 3.383.629 5.491 0 2.108-.215 3.95-.646 5.525-.43 1.575-1.026 2.89-1.785 3.944-.76 1.054-1.677 1.842-2.754 2.363-1.077.521-2.261.782-3.553.782zm-.034-2.55c.839 0 1.61-.176 2.312-.527.703-.351 1.309-.924 1.819-1.717s.907-1.825 1.19-3.094c.283-1.27.425-2.81.425-4.624 0-1.813-.142-3.355-.425-4.624-.283-1.27-.68-2.3-1.19-3.094-.51-.793-1.11-1.366-1.802-1.717-.691-.351-1.456-.527-2.295-.527-.861 0-1.649.176-2.363.527-.714.351-1.326.924-1.836 1.717s-.912 1.825-1.207 3.094c-.295 1.27-.442 2.81-.442 4.624 0 1.813.147 3.355.442 4.624.295 1.27.697 2.3 1.207 3.094.51.793 1.122 1.366 1.836 1.717s1.49.527 2.329.527zm12.44-8.736l8.154-12.996h1.944l-8.154 12.996H22.81zm4.536-9.702c0 1.068-.237 1.89-.711 2.466-.474.576-1.119.864-1.935.864-.816 0-1.464-.273-1.944-.819-.48-.546-.72-1.359-.72-2.439 0-1.092.24-1.923.72-2.493.48-.57 1.128-.855 1.944-.855.816 0 1.461.273 1.935.819.474.546.711 1.365.711 2.457zm-3.438.036c0 .672.066 1.143.198 1.413s.33.405.594.405c.264 0 .462-.135.594-.405.132-.27.198-.741.198-1.413 0-.684-.063-1.158-.189-1.422s-.327-.396-.603-.396c-.276 0-.477.132-.603.396s-.189.738-.189 1.422zm9.756 6.372c0 1.068-.237 1.89-.711 2.466-.474.576-1.119.864-1.935.864-.804 0-1.449-.276-1.935-.828-.486-.552-.729-1.362-.729-2.43 0-1.092.243-1.923.729-2.493.486-.57 1.131-.855 1.935-.855.816 0 1.461.273 1.935.819.474.546.711 1.365.711 2.457zm-3.438.036c0 .672.069 1.14.207 1.404.138.264.333.396.585.396.276 0 .48-.132.612-.396s.198-.732.198-1.404c0-.672-.066-1.143-.198-1.413s-.336-.405-.612-.405c-.264 0-.462.135-.594.405-.132.27-.198.741-.198 1.413z' fill-rule='evenodd' opacity='.3'/%3E%3C/svg%3E&quot;) center center / contain no-repeat !important;\"></div><div style=\"display: inline-block !important; width: calc(100% - 50px) !important; margin-bottom: 20px !important;\"><div style=\"font-size: 15px !important; line-height: 21px !important; font-weight: bold !important; margin-bottom: 4px !important;\">Можно без процентов</div><div style=\"font-size: 13px !important; line-height: 17px !important;\">Если погасить кредит в первые несколько месяцев, переплаты нет</div></div></div></div>")}}),$(document).on("click","#products .product-item .cart-btn",function(){return e.addToCart(this,!0)}),$(document).on("click","#products .product-item .bell-btn",function(){return window.location.hash="form-information",e.addSubscriber(this,!0)}),$(document).on("click",n.find(".cart-item .delete").selector,function(){return e.update(this,"delete")}),$(document).on("click",n.find("#view-cart .delete-item").selector,function(){return e.update(this,"delete",!0)}),$(document).on("change","#products-cart-left .num-items",function(){return e.update(this)}),$(document).on("click",n.find("#view-cart .restore-item").selector,function(){return e.restoreItem(this)}),$(document).on("click",e.clientData.find(".btn-send").selector,function(){return e.afterCheckGrecapcha(function(){$("#product-order-form").submit()}),!1}),$(document).on("change",'.payments-step input[type="radio"][data-name="paymethod"]',function(){var e=$('.payments-step input[type="radio"]:checked').val();return $('.payments-step input[type="radio"]:checked').prop("checked",!0),"2"==e?$("#paymentmethod-2-inputs").show():$("#paymentmethod-2-inputs").hide(),!1}),$(document).on("change",'.payments-step input[type="radio"][data-name="paymethod_grid9"]',function(){var t=$('.payments-step input[type="radio"]:checked').val();return $('.payments-step input[type="radio"]:checked').prop("checked",!0),"2"==t?$("#paymentmethod-2-inputs, .payments-step .cart__button_send").show():$("#paymentmethod-2-inputs, .payments-step .cart__button_send").hide(),e.afterCheckGrecapcha(function(){$("#product-order-form").submit()}),!1}),e.submitOrderForm(),e.confirmOrderForm(),e.initUploadFile(),$("#delivery-choose").find(".delivery-choose").change(function(){var t=$("input.delivery-choose:checked");$(".without-delivery").toggle(t.hasClass("delivery-type-2")),$(".with-delivery").toggle(!t.hasClass("delivery-type-2"));var i=parseInt(t.data("dlvr"));return $("#product-order-form").find("#dlvrId").val(i),e.totalChanged(),!1}),$(document).on("change","#product-params-view .ptype-view-select",function(){return e.updateProductCost(this)}),$(document).on("change","#product-params-view-responsive .nh-select__input",function(){var t=$(this).parents(".nh-select-ptype-js");return e.updateProductCost(t,!0)}),$("#product-order-form").find(".vertical-radio input:radio").prop("checked",!1),$(document).on("click","#view-cart input[type=radio]",function(){var e=$(this);"payments-14"==e.attr("id")?$("#qiwi_phone_container").show():$("#qiwi_phone_container").hide(),"payments-204"==e.attr("id")?$("#pscb_phone_container").show():$("#pscb_phone_container").hide()}),$(document).on("change",'.payments-step input[data-name="paymethod"]',function(){var e=$('input[data-name="paymethod"]:checked');if(e.length>0){var t=$(".payments-step .btn-send"),i=e.val();0==i||2==i||1==i?t.html(view.translate("Отправить заказ")):t.html(view.translate("Перейти к оплате")),t.removeClass("disable")}}),i&&($(".prev-step-cart").on("click",function(t){return e.toCartStep(),!1}),$(".btn-shipping-step").on("click",function(){e.toShippingStep()}),$("#product-order-form .btn-get-shipping").on("click",function(){console.log("_self.sendOrderForShipping"),e.sendOrderForShipping()}),$(".order-confirm .prev-step-shipping-info").on("click",function(){var t=$(".contacts-step"),i=$(".pay-step");return t.addClass("active"),i.removeClass("active"),e.backToContactStep(),!1}),$(document).on("change",'.order-confirm  .payments-step input[data-name="paymethod_grid9"]',function(){return e.afterCheckGrecapcha(function(){$(".order-confirm").submit()}),!1}))},toCartStep:function(){var e=$(".contacts-step"),t=$(".cart-step"),i=$(".pay-step");$(".shipping-step").removeClass("active"),$("#shipping-info").hide(),i.find(".separate").removeClass("arrow_step_fl").removeClass("arrow_step_fr").addClass("arrow_step"),e.find(".separate").removeClass("arrow_step_fr").addClass("arrow_step_fl"),t.addClass("active"),e.removeClass("active"),i.removeClass("active"),$(".payments-step").hide(),this.clientData.hide(),this.orderData.show()},setPromoCode:function(e,t){this.promocode=e,$("#promocode").val(t),$("#total-discount-element").css("display","")},hideDiscount:function(){this.promocode=null,$("#total-discount-element").css("display","none")},checkPromoCode:function(){var e=this,t=$("#promocode-form").find("input").val();return t&&(Cart.countUpdated=!0,PromoCodeService.getDiscountPromoCode(t).then(function(i){e.totalSumm=i.totalSumm,i.success?e.setPromoCode(i,t):e.hideDiscount(),e.calculateSumm(),setTimeout(function(){Cart.countUpdated=!1,$(document).off("toContactStep")},10)}).fail(function(){ntNotification.showError("Произошла ошибка")})),!1},getParamsValues:function(e){var t={},i=[],n=this;return"product-params-view-responsive"===e[0].id?(t=e.find(".nh-select-ptype-js"),t.each(function(){var e=$(this).find("input:checked");Boolean(e.length)&&i.push(e.val()),n.paramIsSelected($(this),!0)})):(t=e.find(".ptype-view-wrapper select"),t.each(function(){parseInt(this.value)&&i.push(this.value),n.paramIsSelected($(this))})),t.length===i.length?i:[]},grabParams:function(e){var t=[],i=$("#product-params-view").length>0?$("#product-params-view"):$("#product-params-view-responsive");if(i.length<=0)return void e(t);t=this.getParamsValues(i),t.length?e(t):ntNotification.showWarning("Выберите все параметры",4e3)},grabParamsAndAdd:function(e){var t=this;t.grabParams(function(i){t.addToCart(e,!1,i)})},addSubscriber:function(e,t){var i=1==t?$(e).parents(".product-item"):$(e).parents(".item-content");if(i.length>0){var n=$(i).attr("id").replace("item","")||0;t&&$(e).hasClass("js-bell-btn");Nethouse.Modal.openHtmlAjax("/products/getform/"+n,{opts:{type:"ajax",data:{type:7}},error:"Ошибка при загрузке формы",open:function(){el=$("#notify-form");var e=el.attr("data-type");return el.validate({submitHandler:function(t){Notifier.showIndicator("notify-edit-window",!0),$(t).ajaxSubmit({dataType:"json",success:function(t){Notifier.hideIndicator("notify-edit-window",!0);try{if(void 0!=t&&1==t.success){if(t.script_url){var i=document.createElement("script");i.async=!0,i.src=t.script_url,document.body.appendChild(i)}Nethouse.Modal.close(),setTimeout(function(){ntNotification.showSuccess(view.translate("Форма успешно отправлена"));var t=Nethouse.DynamicForm.getSubmitHash(e);t&&(window.location.hash=t)},300)}else{var n=t.msg||view.translate("Ошибка при отправке письма!");Notifier.showError(n)}}catch(e){ntNotification.showError(e)}}})},focusInvalid:!1,focusCleanup:!0,rules:function(){return $rules={email:{required:!0,maxlength:50,email:!0}}},messages:function(){return{email:{maxlength:view.translate("Введено больше символов"),required:view.translate("Обязательное поле"),email:view.translate("Неверный формат почты")}}}}),!0}})}return!1},addToCart:function(e,t,i){var n=1==t?$(e).parents(".product-item"):$(e).parents(".item-content"),o=i||[];if(n.length>0){var a=$(n).attr("id").replace("item","")||0,r=t&&!$(e).hasClass("js-cart-btn")?void 0:e;this.push({itemId:a,num:1,getcart:1,button:r,productParams:o})}return"undefined"!=typeof fbq&&"undefined"!==fbq.pixel_id&&fbq("track","AddToCart"),!1},push:function(e){var t=this;return void 0!=e&&$.post(t.pushUrl,{cid:e.itemId,num:e.num,getcart:e.getcart||0,productParams:e.productParams},function(i){try{if(_.isUndefined(i)||1!=i.success){var n=void 0!=i.msg?i.msg:"Произошла ошибка, попробуйте  позже";throw new Error(n)}if(!_.isUndefined(i)){var o=$("<div>"+i.cart+"</div>").find("#"+t.blockLeft),a=$("#"+t.blockLeft);a.length>0?a.replaceWith(o):$(".cart-is-empty").replaceWith(o)}"restore"==e.action&&t.markItem(e.elementId,!0),e.callback&&e.callback(),void 0!=e.button&&Notifier.showNotice($(e.button).parent(),view.translate("Товар добавлен"),!0),$(document).trigger("cart.update",i.show)}catch(e){ntNotification.showError(e.message)}},"json"),!1},update:function(e,t,i){e=$(e);var n,o=this,a=t||"update",r=i||!1,s=r?e.parents("tr").eq(0).attr("id").replace("item",""):e.parents(".cart-item").eq(0).data("cid");if(Cart.countUpdated=!0,void 0==s)return!1;if(n={cid:s,act:a},"update"==a){var d=e.val();if(!view.isInt(d)||d<0)return e.val(e.data("value")),Cart.countUpdated=!1,!1;0==d?n.act="delete":$.extend(n,{num:d})}$.post(this.updateUrl,n,function(t){try{if(void 0==t||1!=t.success){if(t.noProductInStock)return o.showNumErrors(t.noProductInStock),e.val(t.noProductInStock[s]),void o.update(e,"update",i);void 0!=t.num&&e.val(e.data("value"));var c=t.msg||view.translate("Произошла ошибка, попробуйте  позже");throw new Error(c)}var l=e.data("pid"),u=e.data("price"),p=$("#cart-inner").find('.price-info[rel="product-'+l+'"]');switch(a){case"update":0==d&&(r?o.markItem(n.cid):o.removeItem(n.cid));var m=u*d;m=parseFloat(m.toFixed(2)),p.html(m),o.calculateSumm(),e.data("value",e.val());break;case"delete":r?o.markItem(n.cid):o.removeItem(n.cid)}$(document).trigger("cart.update",t.show)}catch(e){ntNotification.showError(e.message)}setTimeout(function(){Cart.countUpdated=!1,$(document).off("toContactStep")},10)},"json").then(function(){this.checkPromoCode()}.bind(this))},removeItem:function(e){$("#cid"+e).remove(),0==$("#"+this.blockLeft+" .cart-item").length&&$("#"+this.blockLeft).replaceWith('<div class="cart-is-empty">')},markItem:function(e,t){var i,n;if(void 0!=e){var o=t||!1,a=$("#item"+e);o?(i="delete-item",n="",a.find(".num-items").prop("disabled",!1)):(i="restore-item",n="deleted-item",a.find(".num-items").prop("disabled",!0)),a.find(".cart-manage span").attr("class",i),a.attr("class",n),this.calculateSumm()}return!1},restoreItem:function(e){var t=this,i=$(e).parents("tr.deleted-item").eq(0);if(i.length>0){var n=i.attr("id"),o={itemId:i.data("pid"),elementId:n.replace("item",""),action:"restore"},a=$("#"+n+" .num-items"),r=parseInt(a.val());0==r&&(r=1,a.val(1),o.callback=function(){t.update(a[0],"update",!0)}),o.num=r;var s=$(i).find(".product-params li"),d=[];return s.length>0&&s.each(function(){d.push($(this).data("param"))}),o.productParams=d,this.push(o),!0}return!1},calculateSumm:function(){var e=!0,t=this,i=$("#cart-inner"),n=0;i.length>0&&(i.find('tr:not(".deleted-item") .product-summ').length?($(".cart-empty").hide(),$("#view-cart").find(".has_products").show()):($("#view-cart").find(".has_products").hide(),$(".cart-empty").show(),e=!1),i.find('tr:not(".deleted-item") .product-summ').each(function(){var e=$(this).html().replace("/[^d.]/","");e=""!=e&&e>0?e:0,n+=parseFloat(e)})),n=this.totalSumm?parseFloat(this.totalSumm).toFixed(2):parseFloat(n).toFixed(2),this.promocode&&$("#total-discount-element").find("#total-discount span").html(parseFloat(this.promocode.discount).toFixed(2)),t.setTotal(n),t.setTotalWithShipping(n),t.totalChanged();var o,a=$(".min-order-sum"),r=$(".btn-contact-step"),s=$(".shop-continue");a.length&&(o=a.data("min-sum"),n<o?(a.show(),s.show(),r.hide(),e=!1):(a.hide(),s.hide(),r.show())),e&&$(document).trigger("toContactStep")},getError:function(e,t){for(var i in e)if(e.hasOwnProperty(i)){if("object"==$.type(e[i]))return this.getError(e[i],i);var n={};return n.element=t,n.message=e[i],n}},showError:function(e,t,i){if(e.addClass("error"),!e.is('input[type="checkbox"]')){var n=$('<div class="error -text-error -pull-right -mg-l-10 error-message">');n.text(t),i.find('label[for="'+e.attr("name")+'"]').append(n)}},appendNumError:function(e,t,i,n){var o,a="js-num-products_error";i.addClass("error"),e.addClass(a),o=t.find("."+a),o.length?o.replaceWith(e):t.append(e),this.timeouts[n]&&clearTimeout(this.timeouts[n]),this.timeouts[n]=setTimeout(function(){delete this.timeouts[n],i.removeClass("error"),t.find("."+a).remove()}.bind(this),6e3)},showNumErrors:function(e){var t,i,n,o,a=$("#products-cart-left-show");for(var r in e)e.hasOwnProperty(r)&&(a.length?(n=a.find("#cid"+r),i=n.find("input"),i.val(e[r]),o=$('<div style="margin-top: 3px" class="-text-error"></div>')):(i=$("#item"+r+" input.num-items"),n=i.parent(),o=$('<div class="-mg-t-10 -text-error"></div>')),t=0!=e[r]?view.translate("Осталось")+": "+e[r]:view.translate("Нет в наличии"),o.html(t),this.appendNumError(o,n,i,r))},toShippingStep:function(){var e=this,t=$(".contacts-step"),i=$(".cart-step"),n=$(".pay-step"),o=$(".shipping-step");t.find(".separate").removeClass("arrow_step_fl").addClass("arrow_step_fr"),n.find(".separate").removeClass("arrow_step").addClass("arrow_step_fl"),i.removeClass("active"),t.removeClass("active"),o.addClass("active"),e.orderData.hide(),$.post("/cart/shipping-no-contacts",{promocode:$("#promocode-form").find("input").val()},function(t){t.shipping_form&&(RuntimeDeps.AddIndexApp(Nethouse),e.replaceDataToOrderConfirmForm(t.order_id,t.order_token),e.initShippingOffersForm(t.shipping_form))})},sendOrderForShipping:function(){var e=this;$(this.orderForm).ajaxSubmit({dataType:"json",success:function(t){if(t.shipping_form){var i=$(".contacts-step"),n=$(".pay-step");n.length&&(n.addClass("active"),i.removeClass("active")),$(".payments-step").show(),$("#confirm-info").show(),e.clientData.hide()}}})},initShippingOffersForm:function(e){var t=this;$(".order-confirm #shipping-info-form").html(e),$(".order-confirm #shipping-info").show();var i=setInterval(function(){__NETHOUSE_DISPATCHER__&&(__NETHOUSE_DISPATCHER__.register(function(e){if("CHOOSE_DELIEVERY"===e.action){t.hideShippingOffersForm();var i;e.delievery?(t.deliveryOffer=e.delievery,t.setTotalWithShipping((t.getTotal()+(e.delievery&&parseFloat(e.delievery.price))||0).toFixed(2)),i='<div class="confirm-info__order-summ">Стоимость товаров: '+t.getTotal().toFixed(2)+' руб.</div><div class="confirm-info__delivery-summ">Стоимость доставки: '+(e.delievery&&parseFloat(e.delievery.price)||0).toFixed(2)+' руб.</div><div class="confirm-info__total-summ">Итого: '+t.getTotalWithShipping()+" руб.</div>"):(t.deliveryOffer=null,t.setTotalWithShipping(t.getTotal().toFixed(2)),i='<div class="confirm-info__order-summ">Стоимость товаров: '+t.getTotal().toFixed(2)+' руб.</div><div class="confirm-info__delivery-summ">Доставка: не выбрана</div>');!function(){var e=$(".contacts-step"),i=$(".cart-step"),n=$(".pay-step");$(".shipping-step").removeClass("active"),e.find(".separate").removeClass("arrow_step_fl").addClass("arrow_step_fr"),n.find(".separate").removeClass("arrow_step").addClass("arrow_step_fl"),i.removeClass("active"),e.addClass("active");var o=$("input.delivery-choose:checked");if(o.length){var a=parseInt(o.data("dlvr"));$("#product-order-form").find("#dlvrId").val(a)}t.clientData.show()}(),t.initConfirmForm(i)}}),clearInterval(i))},2e3)},hideShippingOffersForm:function(){$(".order-confirm #shipping-info").hide()},showShippingOffersForm:function(){$(".order-confirm #shipping-info").show()},hideUserForm:function(){$("#product-order-form #user-info").hide()},replaceDataToOrderConfirmForm:function(e,t){$(".order_id").val(e),$(".order_token").val(t)},replaceRecaptchaTokenAtForm:function(e){$(".recaptcha_token").val(e)},initConfirmForm:function(e){$("#confirm-info .total-summ").html(e),this.hasStore?this.showConfirmPaymentForm():this.showConfirmButtons()},hideConfirmForm:function(){$("#confirm-info").hide()},showConfirmPaymentForm:function(){$(".order-confirm .payments-step").show()},backToContactStep:function(){this.hideConfirmForm();var e=$(".contacts-step"),t=$(".cart-step"),i=$(".pay-step"),n=$(".shipping-step");$("#confirm-info").hide(),n.removeClass("active"),e.find(".separate").removeClass("arrow_step_fl").addClass("arrow_step_fr"),i.find(".separate").removeClass("arrow_step").addClass("arrow_step_fl"),t.removeClass("active"),e.addClass("active");var o=$("input.delivery-choose:checked");if(o.length){var a=parseInt(o.data("dlvr"));$("#product-order-form").find("#dlvrId").val(a)}this.clientData.show()},showConfirmButtons:function(){$(".order-confirm .confirm-buttons").show()},isOnlinePayment:function(e){var t=["0","1","2","3","MP"],i=t.map(function(e){return"#payments-"+e+":checked"}).join(", ");return 0===e.filter(i).length},confirmOrderForm:function(){var t=this,i=$(".order-confirm .payments-step"),n=i.find('input[type="radio"][name="payment"]'),o=$(".order-confirm");t.hasStore&&$(document).on("click",'.payments-step input[type="radio"]',function(){var e=parseInt(i.find('input[type="radio"]:checked').val()),t=i.find("label[for=accept_agreement]");0===e||2===e?t.hide():t.show()}),o.validate({submitHandler:function(a){if(console.log("submit"),t.hasStore){if(!$('.payments-step input[type="radio"]:checked').val())return console.log("payment type not selected"),!1}if($("#payer_kpp, #payer_kpp, #payer_name, #payer_address").length&&!$("#payer_kpp, #payer_kpp, #payer_name, #payer_address").valid()&&$("#payments-2").prop("checked"))return console.log("form not valid"),!1;if($(".payments-step .btn-send.disable").length&&$("#payments-2").attr("checked"))return!1;Notifier.showIndicatorBtn($(".btn-send")),t.deliveryOffer&&$("<input />").attr("type","hidden").attr("name","offer").attr("value",JSON.stringify(t.deliveryOffer)).appendTo(o);for(var r=0,s=["inn","kpp","name","address"];r<s.length;r++){var d=s[r];""!=$("#payer_"+d).val()&&$("<input />").attr("type","hidden").attr("name","payer_"+d).attr("value",$("#payer_"+d).val()).appendTo(o)}Notifier.showIndicatorBtn($(".btn-send")),o.ajaxSubmit({dataType:"json",success:function(r){if(r.success){console.log("confirmOrderForm success"),t.calculateSumm();var s=t.getTotalWithShipping();"undefined"!=typeof fbq&&"undefined"!==fbq.pixel_id&&s>0&&fbq("track","Purchase",{value:s,currency:"RUB"});var d=function(){if(r.invoice)window.location=r.invoice,setTimeout(function(){window.location="/cart/checkout"},2e3);else if(t.hasStore&&t.isOnlinePayment(n)){var e=$(r.gateway_form);e.hide(),$("#view-cart").append(e),e.submit()}else window.location="/cart/checkout"},c=r.script_url;if(c){var l=document.createElement("script");l.async=!0,l.src=c,document.body.appendChild(l),setTimeout(d,2e3)}else d()}else{if(Notifier.hideIndicatorBtn($(".btn-send")),r.noProductInStock)return t.toCartStep(),void t.showNumErrors(r.noProductInStock);if(r.message&&ntNotification.showError(r.message),r.errors){var u=t.getError(r.errors),p=$(a).find("#"+u.element);p.length>0?(t.hasStore&&i.find(".prev-step-contacts").trigger("click"),t.showError(p,u.message,o)):ntNotification.showError(e.message)}}}})},showErrors:function(e,i){o.find(".error-message").remove(),$("input.error").removeClass("error");for(var n=0;n<i.length;n++){var a=i[n],r=$(a.element);t.showError(r,a.message,o)}},focusInvalid:!1,focusCleanup:!1,rules:{qiwi_phone:{required:!0,payment_qiwi_phone:!0},nhpay_phone:{required:!0,payment_pscb_phone:!0},accept_agreement:{onecheck:!0},name:{required:!0},email:{identity:!0,required:!1},phone:{required:!0,phone:!0},payer_inn:{required:!0,payer_inn:!0},payer_kpp:{required:!0,payer_kpp:!0},payer_name:{required:!0,payer_name:!0},payer_address:{required:!0,payer_address:!0}},messages:{qiwi_phone:{required:view.translate("Обязательное поле")},nhpay_phone:{required:view.translate("Обязательное поле")},comment:{maxlength:view.translate("Введено больше символов")},adress:{maxlength:view.translate("Введено больше символов")},name:{maxlength:view.translate("Введено больше символов"),required:view.translate("Обязательное поле")},email:{maxlength:view.translate("Введено больше символов"),required:view.translate("Обязательное поле"),email:view.translate("Неверный формат почты")},phone:{maxlength:view.translate("Введено больше символов"),required:view.translate("Обязательное поле")},payer_inn:{maxlength:view.translate("Введено больше символов"),required:view.translate("Обязательное поле")},payer_kpp:{maxlength:view.translate("Введено больше символов"),required:view.translate("Обязательное поле")},payer_name:{maxlength:view.translate("Введено больше символов"),required:view.translate("Обязательное поле")},payer_address:{maxlength:view.translate("Введено больше символов"),required:view.translate("Обязательное поле")}}}),Visitor.bindInputCharCounter()},submitOrderForm:function(){var t=this,i=$(".payments-step"),n=i.find('input[type="radio"][name="payment"]'),o=$(this.orderForm);t.hasStore&&$(document).on("click",'.payments-step input[type="radio"]',function(){var e=parseInt(i.find('input[type="radio"]:checked').val()),t=i.find("label[for=accept_agreement]");0==e||2==e?t.hide():t.show()}),o.validate({submitHandler:function(a){if(console.log("submit"),t.hasStore){if(!$('.payments-step input[type="radio"]:checked').val())return console.log("payment type not selected"),!1}if($("#payer_kpp, #payer_kpp, #payer_name, #payer_address").length&&!$("#payer_kpp, #payer_kpp, #payer_name, #payer_address").valid()&&$("#payments-2").prop("checked"))return console.log("form not valid"),!1;Notifier.showIndicatorBtn($(".btn-send"));for(var r=0,s=["inn","kpp","name","address"];r<s.length;r++){var d=s[r];""!=$("#payer_"+d).val()&&$("<input />").attr("type","hidden").attr("name","payer_"+d).attr("value",$("#payer_"+d).val()).appendTo(o)}Notifier.showIndicatorBtn($(".btn-send")),o.ajaxSubmit({dataType:"json",success:function(r){if(r.success){console.log("submitOrderForm success"),t.calculateSumm();var s=t.getTotalWithShipping();"undefined"!=typeof fbq&&"undefined"!==fbq.pixel_id&&s>0&&fbq("track","Purchase",{value:s,currency:"RUB"});var d=function(){if(r.invoice)window.location=r.invoice,setTimeout(function(){window.location="/cart/checkout"},2e3);else if(t.hasStore&&t.isOnlinePayment(n)){var e=$(r.gateway_form);e.hide(),$("#view-cart").append(e),e.submit()}else window.location="/cart/checkout"},c=r.script_url;if(c){var l=document.createElement("script");l.async=!0,l.src=c,document.body.appendChild(l),setTimeout(d,2e3)}else d()}else{if(Notifier.hideIndicatorBtn($(".btn-send")),r.noProductInStock)return t.toCartStep(),void t.showNumErrors(r.noProductInStock);if(r.message&&ntNotification.showError(r.message),r.errors){var u=t.getError(r.errors),p=$(a).find("#"+u.element);p.length>0?(t.hasStore&&i.find(".prev-step-contacts").trigger("click"),t.showError(p,u.message,o)):ntNotification.showError(e.message)}}}})},showErrors:function(e,i){o.find(".error-message").remove(),$("input.error").removeClass("error");for(var n=0;n<i.length;n++){var a=i[n],r=$(a.element);t.showError(r,a.message,o)}},focusInvalid:!1,focusCleanup:!1,rules:{qiwi_phone:{required:!0,payment_qiwi_phone:!0},nhpay_phone:{required:!0,payment_pscb_phone:!0},accept_agreement:{onecheck:!0},email:{identity:!0},phone:{phone:!0},payer_inn:{required:!0,payer_inn:!0},payer_kpp:{required:!0,payer_kpp:!0},payer_name:{required:!0,payer_name:!0},payer_address:{required:!0,payer_address:!0}},messages:{qiwi_phone:{required:view.translate("Обязательное поле")},nhpay_phone:{required:view.translate("Обязательное поле")},comment:{maxlength:view.translate("Введено больше символов")},adress:{maxlength:view.translate("Введено больше символов")},name:{maxlength:view.translate("Введено больше символов"),required:view.translate("Обязательное поле")},email:{maxlength:view.translate("Введено больше символов"),required:view.translate("Обязательное поле"),email:view.translate("Неверный формат почты")},phone:{maxlength:view.translate("Введено больше символов"),required:view.translate("Обязательное поле")}}}),Visitor.bindInputCharCounter()},paramIsSelected:function(e,t){var i=t?e.parents(".nh-select"):e.parent();(t?Boolean(e.find("input:checked").length):Number(e.val())>0)?i.removeClass(this.paramsNotSelectedClass):i.addClass(this.paramsNotSelectedClass)},updateProductCost:function(e,t){var i=this,n=$("#products-show"),o={price:n.find(".product-content .old-price .product-price-data"),priceSale:n.find(".product-content #cost-by-impact .product-price-data")},a={price:Number(o.price.data("cost")),priceSale:Number(o.priceSale.data("cost"))};a.priceSale>=0&&(t?$("#product-params-view-responsive").find(".nh-select-ptype-js").each(function(){var e=$(this),t=e.find("input:checked"),n=t.length>0?parseFloat(t.data("impact")):0;i.paramIsSelected(e,!0),a.price+=n,a.priceSale+=n}):$("#product-params-view").find(".ptype-view-wrapper select").each(function(){var e=$(this),t=e.find("option:selected"),n=parseFloat(t.data("impact"));i.paramIsSelected(e),a.price+=n,a.priceSale+=n}),a.price=a.price>0?a.price:0,a.priceSale=a.priceSale>0?a.priceSale:0,o.price.html(parseFloat(a.price.toFixed(2))),o.priceSale.html(parseFloat(a.priceSale.toFixed(2))))},initUploadFile:function(){
var e,t,i,n=$(this.orderForm),o=this,a=["doc","docx","xls","xlsx","pdf","jpg","jpeg","gif","png","zip","rar"],r=$(n),s=!1,d=$('<div id="progress"><div class="progressbar-value"></div></div>'),c="fancybox-content",l=r.attr("data-file-upload")||"/putdocpub";r.is("#product-order-form")?i="products-edit-window":r.is("#services-order-form")&&(i="services-edit-window"),(e=r.find(".attach-btn span"))&&e.length>0&&(c=e[0].id,t=new Nethouse.Uploader(e[0],{path:l}),t.addExtensionFilter(a).addFileSizeFilter(20*Nethouse.Uploader.MB).on("before",function(t){t.length&&(Notifier.showIndicator(i),d.hide(),s||(s=!0,e.after(d)),e.hide())}.bind(this)).on("progress",function(e){d.show(),d.find(".progressbar-value").css({width:e.loaded/e.total*100+"%"})}).on("filecomplete",function(t,n,a){if(Notifier.hideIndicator(i),d.hide(),e.show(),t)return void ntNotification.showError(sprintf(window.view.translate("js_uploader_upload_file_fail"),a.name),6e3);var s,l,u,p,m,h,f,v=window.JSON.parse(n.response);v.success&&v.url||ntNotification.showError(sprintf(window.view.translate("js_uploader_upload_file_fail"),a.name),6e3),s=v.url,l=v.name,u=v.size,p=v.timestamp,r.find("#attach-url").val(s),r.find("#attach-name").val(l),r.find("#attach-size").val(u),r.find("#attach-timestamp").val(p),r.find("#"+c+"-hidden").val(s+"#"+l),m=r.find(".attach-info .file-info"),m.find(".attach-file-name").html(l),h=o.getHumanReadableFileSize(u),m.find(".attach-file-size").html(h),m.parent().show(),r.find(".attach-btn").hide(),(f=o.getFileIcon(l))&&r.find(".file-icons").addClass(f)}).on("error",function(t,i){d.hide(),e.show();var n=Nethouse.Uploader.Errors;switch(t){case n.EXTENSION:ntNotification.showError(sprintf(view.translate("js_uploader_extension_fail"),i.file.name,a.join(", ")),6e3);break;case n.MAX_SIZE:ntNotification.showError(sprintf(view.translate("js_uploader_max_size_fail"),i.file.name,"20 MB"),6e3)}}.bind(this)))},getHumanReadableFileSize:function(e){e=parseInt(e);return e>=1048576?Math.round(e/1048576*10)/10+" Мб":e>=1024?Math.round(e/1024*10)/10+" кб":e+" б"},getFileIcon:function(e){e=e.toLowerCase();var t={pdf:[/pdf$/],xls:[/xls$/,/xlsx$/],jpg:[/jpg$/,/jpeg$/],psd:[/psd$/],mp3:[/mp3$/],gif:[/gif$/],ai:[/ai$/],eps:[/eps$/],png:[/png$/],zip:[/zip$/],rar:[/rar$/],txt:[/txt$/],rtf:[/rtf$/],doc:[/doc$/,/docx$/],ppt:[/ppt$/,/pptx$/],djvu:[/djvu$/,/djvue$/],fb:[/fb$/],ps:[/ps$/]},i=null;for(var n in t){var o=t[n];for(var a in o)if(o[a].test(e)){i=n;break}}return i&&(i+="-icon"),i},getUid:function(e){e=e||32;for(var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],i="",n=0;n<e;n++){i+=t[Math.floor(16*Math.random())+0]}return i},startProgressUpload:function(e,t){var i=this,n=$('<div id="progress"><div class="progressbar-value"></div></div>');$(e).after(n).css("display","none"),setTimeout(function(){i.updateProgress(t,n)},1e3)},updateProgress:function(id,progressbar,success){var _self=this;$.ajax({url:"/getprogress",timeout:3e3,headers:{"X-Progress-ID":id},dataType:"script",complete:function(e,t){},error:function(e,t,i){},success:function(data){var response=null;try{response=eval(data)}catch(e){response={}}var progress=0;if(void 0!=response.state)if(void 0!=success&&"function"==typeof success)success(response,id);else{if("uploading"==response.state){var size=response.size,received=response.received;progress=Math.floor(received/size*100),size!=received&&setTimeout(function(){_self.updateProgress(id,progressbar)},1e3)}else{if("starting"==response.state)return void setTimeout(function(){_self.updateProgress(id,progressbar)},500);"done"==response.state&&(progress=100)}progressbar.find(".progressbar-value").stop(!0).animate({width:parseInt(3*progress)+"px"},2e3)}}})}}),$("document").ready(function(){window.Nethouse=window.Nethouse||{},window.Nethouse.cart=new Cart});var Comments;$("document").ready(function(){Comments=function(){this.init()},Comments.prototype={maxImagesQuantity:5,types:{video:6,images:7},init:function(){var e=this;this.commentsAccept=!0,this.initAnswerBtnAllowed=!0,this.id="comment",this.block_id=$("#"+this.id).data("block-id"),this.widget_type=7,this.countSubComments=2,this.page=2,this.showMessage='<span class="comment-item__btn button button_for_comment-toggle-comments">'+view.translate("Показать все комментарии")+"</span>",this.hideMessage='<span class="comment-item__btn button button_for_comment-toggle-comments">'+view.translate("Скрыть комментарии")+"</span>",$("#comment_wrap").length?e.initComments():$(document).on("widget_init",function(){e.initComments()}),this.loadEvents()},initComments:function(){var e=this,t=$("#comment_wrap"),i=t.attr("class");if(0!=$(".widget-comments .comment_wrap").length){var n=$(".widget-comments > .comment_wrap");e.count_roots=n.length,e.prepareOutput(n,!0),t.find(".next_comments").click(function(){e.getWidgetComments(this)})}$(document).on("changeBlock","#comment",function(){var t=$("#comment_wrap");if(0!=t.length&&t.is(":hidden")){var i=$(".widget-comments > .comment_wrap");e.prepareOutput(i,!0),$(".all-comments .answer-btn").click(function(){e.getAnswer(this)}),"undefined"!=typeof CommentsUser&&CommentsUser.reloadEvents()}}),void 0!=i?(this.type=i,this.object=t.find(".comment").attr("id")):this.type="site",0!=t.length&&0!=t.find(".is_scroll").length&&this.commentsAccept&&(e.infiniteScroll(),this.commentsAccept=!1)},initScroll:function(){$("#comment_wrap")},loadEvents:function(){var e=this;$(document).on("click","#comment_wrap .addcomment",function(){var t=$("#form_wrap");return e._getSmallForm($(this),t,!1),!1}),$(document).on("click",".all-comments .answer-btn",function(){e.getAnswer(this)}),this.initAnswerBtnAllowed=!1,$(document).on("click",".window #comment_form .cancel",function(){var t=this;return $(t).parents("#comment_form").slideToggle(function(){e.hideFormAndRevalidate($(t))}),!1}),$(document).on("click",".all-comments .cancel, #comment_wrap .cancel",function(){return $(this).parents("#comment_form").hide(),$(this).parents(".answer-form").hide(),$(this).parents(".comment_wrap ").find(".up-arrow").hide(),e.hideFormAndRevalidate($(this)),!1}),$(document).on("click","#comment-edit .cancel, #comment-edit .close",function(){e.toggleBlock(e.id,"close")}),$(document).on("hideBlocks",function(){e.toggleBlock(e.id,"close")}),$(document).on("click","#comment .add-btn",function(){e.toggleBlock(e.id,"add");var t=$("#"+e.id+"-edit"),i=$("#"+e.id+" i.up-arrow");return $("i.up-arrow").remove(),i.length>0&&i.remove(),e._getSmallForm($(this),t,!1)}),$(document).on("click","#comment_form #reload",function(){e.reloadCaptcha()})},infiniteScroll:function(){var e=this;$(".end_comments").endlessScroll({fireOnce:!0,fireDelay:200,loader:"<img id='loader' src='//s.siteapi.org/frontend/static/grid_6/img/lazyload-da16aabf34.gif'>",url:"/comment/load/getcomments",toElement:!0,params:{type:e.type,object:e.object,page:e.page},success:function(e,t){return!!e.success&&(t.params.page++,e.next_page?$("#comment_wrap .is_scroll .per_page").html(e.count):(t.disable=!0,$("#comment_wrap .is_scroll").removeClass("is_scroll")),void $("#comment_wrap .all-comments").append(e.output))},insertAfter:".all-comments article.comment_wrap:last",callback:function(){CommentsUser.reloadEvents()}})},prepareOutput:function(e,t){var i=this,n='<div class="button-show-'+i.id+' blue">'+i.showMessage+"</div>";e.each(function(){var e=$(this),o=e.find(".button-show-"+i.id),a=e.find(".comment_wrap");a.length>i.countSubComments?(0==o.length&&(e.children("div").after(n),e.find(".button-show-"+i.id).click(function(){i.showSubComments(this)})),!t&&o.hasClass("isshow")||(a.show(),e.find(".comment_wrap:lt("+(a.length-i.countSubComments)+")").hide())):0!=o.length&&(a.show(),o.remove())}),t&&($("#ajax-loader").remove(),$("#"+i.id+"_wrap").show())},showSubComments:function(e){$(".answer-form.comment_wrap").remove();var t=$("#comment-form");0!=t.length&&(t.parent().find(".item").show(),t.remove());var i=this,n=$(e);if(n.hasClass("isshow")){n.removeClass("isshow");var o=n.parent().find(".comment_wrap"),a=o.length;a>i.countSubComments&&(n.html(i.showMessage),n.parent().find(".comment_wrap:lt("+(a-i.countSubComments)+")").hide())}else n.addClass("isshow"),n.html(i.hideMessage),n.parent().find(".comment_wrap").show()},getAnswer:function(e){var t=this;$(e).parent().parent().find(".answer-form").remove();var i=$(e).parents(".item").attr("id").replace("item-",""),n=$('<article id="parent-'+i+'" class="answer-form"><div><div></article>');return $(e).parent().after(n),$("i.up-arrow").remove(),0!=$("#comment-edit:visible").length&&($("#comment_form").remove(),t.toggleBlock(t.id,"add")),t._getSmallForm($(e),n,!0),!1},hideFormAndRevalidate:function(e){var t=this,i=$(e).parents("form"),n=0!=$(e).parents(".fancybox-inner").length,o=i.parent(),a=i.clone();o.append(a),i.remove(),n?t.validateWindowForm(a):"site"==t.type?t.validateWidgetForm(a):t.validateForm(a),a.find(".js-comment-images__list").html(""),this.initImageUpload(a)},toggleBlock:function(e,t){$(".on-edit:not(.static)").hide(),$(".content-block").show(),$(".content-block").parents("section").addClass("on-view"),$("header.infoPlate").each(function(){0==$(this).parents("#"+e).length&&($(this).children(".edit-block").find("a").removeClass("active-btn"),$(this).find(".add-btn").removeClass("active-btn"))}),$("#header-wrapper .edit-block").find("a.active-btn").removeClass("active-btn"),$("#header-wrapper").attr("class","");var i=$("#"+e).hasClass("overt");if("edit"==t||"add"==t){var n="add"==t?"edit":"add";$("#"+e+" ."+t+"-btn").hasClass("active-btn")?($("#"+e+"-edit").hide(),$("#"+e+" .no-entry").show(),$("#"+e+"-show").show(),$("#"+e).addClass("on-view"),$("#"+e+" ."+t+"-btn").removeClass("active-btn")):($("#"+e+"-edit").show(),i||$("#"+e+"-show").hide(),$("#"+e+" .no-entry").hide(),$("#"+e).removeClass("on-view"),$("#"+e+" ."+t+"-btn").addClass("active-btn"),$("#"+e+" ."+n+"-btn").removeClass("active-btn"))}else $("#"+e+"-edit").hide(),$("#"+e+"-show").show(),$("#"+e+" .no-entry").show(),$("#"+e).addClass("on-view"),$("#"+e+" .edit-btn").removeClass("active-btn"),$("#"+e+" .add-btn").removeClass("active-btn");return void 0!=t||"contactsmain"!=e&&"contactssocnet"!=e||$("#content #"+e+"-form").remove(),!1},getWidgetComments:function(e){var t=this;$("#comment_wrap .next_comments span").hide(),$("#comment_wrap .next_comments").append("<img id='loader' src='//s.siteapi.org/frontend/static/grid_6/img/lazyload-da16aabf34.gif'>"),$.post("/comment/load/getsitecomments",{page:t.page},function(e){if($("#comment_wrap #loader").remove(),e.success){t.page++;var i=$(e.output);t.prepareOutput(i),$(".all-comments.widget-comments").append(i),"undefined"!=typeof CommentsUser&&CommentsUser.reloadEvents(),this.initAnswerBtnAllowed&&i.find(".answer-btn").click(function(){t.getAnswer(this)}),e.next_page?$("#comment_wrap .next_comments span").show():$("#comment_wrap .next_comments").remove()}else $("#comment_wrap .next_comments span").show(),ntNotification.showError("Произошла ошибка")},"json")},initFormImages:function(e,t){e.find(".js-comment-image").each(function(){var t=$(this);t.find(".js-comment-image__delete").on("click",function(){t.remove(),e.find(".js-comment-images__upload").show()}.bind(this))})},getImagesQuatity:function(e){return e.find(".js-comment-images__list .js-comment-image:not(.upload-image_fail)").length},initImageUpload:function(e){e.find(".js-comment-images").show();var t,i=e.find(".js-comment-images__list"),n=e.find(".js-comment-images__upload"),o=n.data("file-upload"),a=["jpeg","png","gif","jpg"],r=$(".js-comment-image-tpl").html(),s=this.maxImagesQuantity-this.getImagesQuatity(e);0!=n.length&&(s>0&&n.show(),t=new Nethouse.ImageUploader(n[0],{multiple:!0,path:o}),t.preview(90,60,function(t,o){t=$(r).append(t),i.append(t),t.addClass("js-comment-image_"+o),t.find(".js-comment-image__delete").on("click",function(){t.remove(),this.getImagesQuatity(e)<this.maxImagesQuantity&&n.show()}.bind(this))}.bind(this)).addExtensionFilter(a).addFileSizeFilter(5*Nethouse.Uploader.MB).on("before",function(){t.maxFiles=this.maxImagesQuantity-this.getImagesQuatity(e)}.bind(this)).on("filecomplete",function(t,o,a){if(t)return void ntNotification.showError(sprintf(view.translate("js_uploader_upload_file_fail"),a.name),6e3);var r=window.JSON.parse(o.response),s=new Nethouse.FileModel(r),d=this.getImagesQuatity(e);i.find(".js-comment-image_"+a.id).append(s.toInputFields(a.id,"attachments")),d>=this.maxImagesQuantity&&n.hide()}.bind(this)).on("error",function(e,t){var i=Nethouse.Uploader.Errors;switch(e){case i.EXTENSION:ntNotification.showError(sprintf(view.translate("js_uploader_extension_fail"),t.file.name,a.join(", ")),6e3);break;case i.MAX_SIZE:ntNotification.showError(sprintf(view.translate("js_uploader_max_size_fail"),t.file.name,"5 MB"),6e3);break;case i.MAX_FILES_COUNT:ntNotification.showError(sprintf(view.translate("js_uploader_files_count_fail"),this.maxImagesQuantity),6e3)}}.bind(this)))},_getSmallForm:function(e,t,i){var n=this;if($(".comment_wrap.answer-form").not(t).remove(),$("#comment_form").parents(".answer-form").remove(),$("section#comment #comment-edit #comment_form").remove(),$(".comment_wrap #comment_form").remove(),$(".comment_wrap .item").show(),i)var o=e.parents(".item").attr("id").replace("item-","");if(e.hasClass("active-btn")||"site"!=n.type||i){"site"==n.type&&e.append('<i class="up-arrow"></i>');var a=Notifier.getLoader();t.html('<div class="ajax-loader">'+a+"</div>");var r="/"+n.id+"/load/getform";$.post(r,{type:n.type,object:n.object,parent:o},function(i){var o,a;i.success?($("."+n.id+"_wrap #"+n.id+"_form").remove(),a=t.html(i.form),n.initFormImages(a.find("form")),n.initImageUpload(a.find("form")),"site"==n.type?(a.children("form").removeClass("fromTable").addClass("new-item"),n.validateWidgetForm(a.children("form"))):(n.ReloadEvents(e),n.validateForm(a.children("form")))):($("#"+n.id+" .no-entry").show(),o=$(i.form).closest(".block-error").length>0?i.form:"Ошибка",$("#comment-edit").empty(),Notifier.showError(o,"#comment-edit"))},"json")}return!1},getCookie:function(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0},ReloadEvents:function(e){var t=this;e.unbind("click"),e.click(function(){$(".comment_wrap #comment_form").remove(),$(".comment_wrap .item").show();var e=$("#comment_form");e.is(":hidden")?t.reloadCaptcha():e.hide()})},highlight:function(e,t){$(e).addClass(t)},unhighlight:function(e,t){$(e).removeClass(t).next(".errors")},showErrors:function(e,t){$("#comment_form .errors").remove(),$("#comment_form .error").removeClass("error");for(var i=0;i<t.length;i++){var n=t[i],o=$(n.element),a=$('<ul class="errors">');a.append($("<li>").text(n.message)),o.hasClass("cleditor")?a.insertAfter(o.parents(".cleditorMain").find("iframe")):a.insertAfter(o),this.settings.highlight.call(this,n.element,"error")}},validateWindowForm:function(e){var t=this;e.validate({showErrors:t.showErrors,unhighlight:t.unhighlight,highlight:t.highlight,submitHandler:function(e){return Notifier.showIndicator("comment_form",!1),$(e).ajaxSubmit({dataType:"json",success:function(e){if(Notifier.hideIndicator("comment_form",!1),e.success){if($(".window #comment_form").slideToggle(),!e.approved)return t.cleanForm(),void t.notApprovedNotification();e.isNew?($(".window .all-comments").append(e.comment),0==$("#comment_wrap header .info h2").length&&$("#comment_wrap header .info").append('<h2 class="not_scroll">Комментарии</h2><div class="bold_sep"><hr></div>'),t.cleanForm()):$(".window .all-comments #item-"+e.item).parent().replaceWith(e.comment),"undefined"!=typeof CommentsUser?CommentsUser.reloadEvents():t.reloadCaptcha()}else e.captchaFaild?(t.reloadCaptcha(),t.captchaError()):($(".comment_wrap .item").show(),ntNotification.showError("Произошла ошибка"))},beforeSubmit:function(){Notifier.showIndicator("comment_wrap",!1)}}),!1},rules:t.rules,messages:t.messages,focusInvalid:!1,focusCleanup:!0})},validateForm:function(e){var t=this;e.validate({showErrors:t.showErrors,unhighlight:t.unhighlight,highlight:t.highlight,submitHandler:function(e){return Notifier.showIndicator("comment_form",!1),$(e).ajaxSubmit({dataType:"json",success:function(e){if(Notifier.hideIndicator("comment_form",!1),e.success){if($("#comment_form").hide(),$(".answer-form").remove(),!e.approved)return void t.notApprovedNotification();if(e.isNew){if(e.parent?$("#comment_wrap .all-comments #item-"+e.parent).parent().append(e.comment):$("#comment_wrap .all-comments").prepend(e.comment),t.cleanForm(),0!=$("#comment_wrap .no-comments").length)$("#comment_wrap .no-comments").replaceWith('<h2 class="not_scroll">Комментарии</h2>'),$("#comment_wrap .bold_sep").html("<hr/>");else if(0!=$("#comment_wrap .is_scroll").length){var i=$("#comment_wrap .is_scroll .per_page"),n=$("#comment_wrap .is_scroll .total"),o=parseInt(i.text())+1,a=parseInt(n.text())+1;n.html(a),i.html(o)}}else $(".all-comments #item-"+e.item).parent().replaceWith(e.comment);"undefined"!=typeof CommentsUser&&CommentsUser.reloadEvents()}else e.captchaFaild?(t.reloadCaptcha(),t.captchaError()):($(".comment_wrap .item").show(),ntNotification.showError("Произошла ошибка"))},beforeSubmit:function(){Notifier.showIndicator("comment_wrap",!1)}}),!1},rules:t.rules,messages:t.messages,focusInvalid:!1,focusCleanup:!0}),Visitor.bindInputCharCounter()},validateWidgetForm:function(e){var t=this;e.validate({showErrors:t.showErrors,unhighlight:t.unhighlight,highlight:t.highlight,submitHandler:function(e){return Notifier.showIndicator("comment_form",!1),$(e).ajaxSubmit({dataType:"json",success:function(e,i,n){if(Notifier.hideIndicator("comment_form",!1),e.success){if(!e.approved)return t.cleanForm(),t.notApprovedNotification(),void(e.parent?$("#comment_form").parent().hide():t.toggleBlock(t.id,"add"));if(e.isNew){$("#comment_form").parent().hide(),$("i.up-arrow").remove(),$("#comment .no-entry").remove();var o=$(e.comment);if(e.parent){var a=$("#comment .all-comments #item-"+e.parent).parent();a.append(o),t.prepareOutput(a,!1)}else t.toggleBlock(t.id,"add"),o.find(".answer-btn").click(function(){t.getAnswer(this)}),$("#comment .all-comments").prepend(o);t.cleanForm(),"undefined"==typeof CommentsUser&&t.reloadCaptcha()}else{var r=$("#comment .all-comments #item-"+e.item);r.parent().find("#comment_form").remove();var o=$(e.comment);o.find(".answer-btn").click(function(){t.getAnswer(this)}),r.replaceWith(o)}"undefined"!=typeof CommentsUser&&CommentsUser.reloadEvents()}else e.captchaFaild?(t.reloadCaptcha(),t.captchaError()):($(".comment_wrap .item").show(),ntNotification.showError("Произошла ошибка"))},beforeSubmit:function(){Notifier.showIndicator("comment_wrap",!1)}}),!1},rules:t.rules,messages:t.messages,focusInvalid:!1,focusCleanup:!0}),Visitor.bindInputCharCounter()},captchaError:function(){$("#comment_form #captcha-input").val("").addClass("error"),$("#comment_form #captcha-element").append('<ul class="errors"><li>'+view.translate("Неверно введены символы, указанные на картинке.")+"</li></ul>")},cleanForm:function(){$('#comment_form input[type="text"], #comment_form textarea').val(""),$("#comment_form #captcha-input").val("")},rules:{name:{required:!0,maxlength:40},commenttext:{required:!0,maxlength:3e3},"captcha[input]":{required:!0,minlength:6,maxlength:6}},messages:{name:{required:view.translate("Обязательное поле"),maxlength:view.translate("Максимальная длина")+" 40 "+view.translate("символов")},commenttext:{required:view.translate("Обязательное поле"),maxlength:view.translate("Максимальная длина")+" 3000 "+view.translate("символов")},"captcha[input]":{required:view.translate("Обязательное поле"),maxlength:view.translate("Введено не")+" 6 "+view.translate("символов"),minlength:view.translate("Введено не")+" 6 "+view.translate("символов")}},reloadCaptcha:function(){"undefined"==typeof CommentsUser&&$.post("/comment/load/captcha",function(e){e.success?($("#comment_form #captcha-element img").attr("src",e.image),$("#comment_form #captcha-id").val(e.captcha)):ntNotification.showError("Произошла ошибка")},"json")},notApprovedNotification:function(){ntNotification.showSuccess(view.translate("comment_is_not_approved"),6e3)}},Comments=new Comments}),function(e,t){"use strict";e(document).on("click",".js-cancel-window, .window .close",function(){return e.magnificPopup.close(),!1}),e(document).ready(function(){e.magnificPopup.defaults.gallery.tCounter="%curr% "+t.view.translate("из")+" %total%"});var i={loaded:function(){},parseItem:function(){},beforeOpen:function(){},open:function(){},close:function(){},imageLoaded:function(){},change:function(){},type:"inline"},n={openHtmlAjax:function(n,o){o=o||{},o=e.extend({},i,o),e.magnificPopup.open({tLoading:'<img src="//s.siteapi.org/frontend/static/grid_6/img/preloader-c6f1ad4957.gif">',items:{type:"ajax",src:n},ajax:{settings:o.opts,tError:o.error},removalDelay:300,mainClass:"mfp-fade",showCloseBtn:!1,fixedContentPos:!0,callbacks:{beforeOpen:function(){e(document).trigger("modal:beforeOpen"),e("html").addClass("modal-open"),o.beforeOpen()},parseAjax:function(t){e(document).trigger("modal:open"),o.loaded(t,this)},ajaxContentAdded:function(){e(".mfp-content").addClass("site-popup"),o.open()},close:function(){e("html").removeClass("modal-open"),t.history.pushState("",document.title,t.location.pathname),e(document).trigger("modal:close")}}})},update:function(){e.magnificPopup.instance.updateItemHTML()},imageGallery:function(n,o){o=o||{},o=e.extend({},i,o),n.magnificPopup({type:"image",fixedContentPos:!0,callbacks:{beforeOpen:function(){e(document).trigger("modal:beforeOpen"),e("html").addClass("modal-open"),o.beforeOpen()},open:function(){e(document).trigger("modal:open"),o.open(this.items)},close:function(){e("html").removeClass("modal-open"),t.history.pushState("",document.title,t.location.pathname),o.close(),e(document).trigger("modal:close")}},gallery:{enabled:!0,preload:[1,4]}})},item:function(t,n){n=n||{},n=e.extend({},i,n),e.magnificPopup.open({type:n.type,fixedContentPos:!0,items:{src:t},callbacks:{beforeOpen:function(){e(document).trigger("modal:beforeOpen"),e("html").addClass("modal-open"),n.beforeOpen()},open:function(){e(document).trigger("modal:open"),n.open(this.items)},close:function(){e("html").removeClass("modal-open"),n.close(),e(document).trigger("modal:close")}}})},openListImages:function(n,o,a,r){r=r||{},r=e.extend({beforeNext:function(){return!0},beforePrev:function(){return!0}},i,r),e.magnificPopup.open({items:n,type:"image",fixedContentPos:!0,callbacks:{beforeOpen:function(){e(document).trigger("modal:beforeOpen"),e("html").addClass("modal-open"),r.beforeOpen()},open:function(){this.next=function(){r.beforeNext(this)&&e.magnificPopup.proto.next.call(this)},this.prev=function(){r.beforePrev(this)&&e.magnificPopup.proto.prev.call(this)},e(document).trigger("modal:open"),r.open(this)},close:function(){e("html").removeClass("modal-open"),t.history.pushState("",document.title,t.location.pathname),r.close(),e(document).trigger("modal:close")},imageLoadComplete:function(){r.imageLoaded(this.currItem,this.items)},change:function(){r.change(this.currItem,this,this.direction)}},image:{verticalFit:!1,markup:o},gallery:{enabled:!0,preload:[1,4]}},a)},openHtml:function(n,o,a){var r;a=!!_.isUndefined(a)||a,r=a?e(n).wrap('<div class="window"></div>').parent():e(n),o=o||{},o=e.extend({},i,o),e.magnificPopup.open({tLoading:'<img src="//s.siteapi.org/frontend/static/grid_6/img/preloader-c6f1ad4957.gif">',items:{src:r,type:"inline"},removalDelay:300,mainClass:"mfp-fade",fixedContentPos:!0,showCloseBtn:!1,callbacks:{beforeOpen:function(){e(document).trigger("modal:beforeOpen"),e("html").addClass("modal-open"),o.beforeOpen()},open:function(){e(document).trigger("modal:open"),o.open()},close:function(){e("html").removeClass("modal-open"),t.history.pushState("",document.title,t.location.pathname),o.close(),e(document).trigger("modal:close")}}})},showLoader:function(){e("body").prepend('<div class="-screen-loader"><div><div class="-screen-loader-img"><img src="//s.siteapi.org/frontend/static/grid_6/img/preloader-c6f1ad4957.gif"></div></div></div>')},hideLoader:function(){e("body > .-screen-loader").remove()},close:function(){e.magnificPopup.close()}};t.Nethouse=t.Nethouse||{},t.Nethouse.Modal=n}(window.$,window),$(document).ready(function(){var e,t=$(".notify-line");t.length&&(e=$("<style> .goog-te-banner-frame { top: "+t.height()+"px; } </style>"),$("head").append(e),$(".notify-line__close").on("click",function(){var i=new Date;return i.setMinutes(i.getMinutes()+5),document.cookie="notify_line=1; path=/; expires="+i.toUTCString(),t.remove(),$(".notify-line__height").remove(),e.remove(),!1}))});var ntNotification={templates:{},notifications:[],getTemplate:function(e,t){var i=this;this.templates[e]?t(i.templates[e]):$.get("/html/ru_RU/utils/notification.html",function(n){i.templates[e]=n,t(i.templates[e])})},getTop:function(e){return parseInt(e.css("top").replace("px",""))},moveAll:function(e,t){var i=this;_.forEach(i.notifications,function(n,o){if(o>=e)if(e!=o){var a=i.notifications[o-1].elm;t=t+a.outerHeight()+5,n.elm.animate({top:t+"px"},200)}else n.elm.animate({top:t+"px"},200)})},deleteNotification:function(e,t){var i=this,n=_.indexOf(i.notifications,e),o=i.getTop(e.elm);e.timeout&&clearTimeout(e.timeout),i.notifications=_.without(i.notifications,e),e.elm.stop(!0,!0),t?e.elm.animate({left:e.elm.width()+"px",opacity:0},200,function(){e.elm.remove(),i.moveAll(n,o)}):e.elm.animate({top:o-e.elm.outerHeight()+"px",opacity:0},200,function(){e.elm.remove(),i.moveAll(n,o)})},shake:function(e){for(var t=0;t<6;t++)$(e).animate({"margin-left":t%2==0?5:-5},{duration:70,queue:!0});$(e).animate({"margin-left":0},70)},getPageX:function(e){var t=0;if("touchstart"==e.type||"touchmove"==e.type||"touchend"==e.type||"touchcancel"==e.type){t=(e.originalEvent.touches[0]||e.originalEvent.changedTouches[0]).pageX}else"mousedown"!=e.type&&"mouseup"!=e.type&&"mousemove"!=e.type&&"mouseover"!=e.type&&"mouseout"!=e.type&&"mouseenter"!=e.type&&"mouseleave"!=e.type||(t=e.pageX);return t},show:function(e,t,i){var n=this,o=CryptoJS.SHA1(t).toString(),a=_.findWhere(n.notifications,{id:o}),r=!_.isUndefined(i)&&i;if(a){if(a.elm.stop(!0,!0),n.shake(a.elm),a.timeout){clearTimeout(a.timeout);var s=a.elm.find(".-notification-timer");s.stop(!0,!0),s.css({width:""}),s.animate({width:0},a.time),a.timeout=setTimeout(function(){n.deleteNotification(a)},a.time)}}else this.getTemplate(e,function(a){window.view&&window.view.translate&&(t=window.view.translate(t));var s={id:o,elm:$(_.template(a)({type:e,message:t,hasTimer:r}))};if(s.elm.data("id",o),n.notification_box||(n.notification_box=$('<div class="-notification-box"></div>'),$(document).on("click",".-notification-close, .-notification-box .-notification-icon",function(){var e=_.findWhere(n.notifications,{id:$(this).parent().eq(0).data("id")});e&&n.deleteNotification(e)}),$(document).on("touchstart",".-notification",function(e){var t=_.findWhere(n.notifications,{id:$(this).data("id")});t.elm.css("left",0);var i=n.getPageX(e),o=t.elm.offset();$(document).on("touchmove.notification",function(e){var a=n.getPageX(e),r=a-i;r>0?t.elm.css({left:r+"px"}):o.left<a?i=a:$(document).off("touchmove.notification touchend.notification"),r>100&&($(document).off("touchmove.notification touchend.notification"),n.deleteNotification(t,!0))}),$(document).on("touchend.notification",".-notification",function(){t.elm&&t.elm.css({left:0}),$(document).off("touchmove.notification touchend.notification")})}),n.notification_box.css({top:0}),$("body").append(n.notification_box)),s.elm.css({opacity:0,top:0}),n.notification_box.append(s.elm),0!=n.notifications.length){5==n.notifications.length&&n.deleteNotification(n.notifications[n.notifications.length-1]);var d,c=function(){};_.forEach(n.notifications,function(e,t){if(t==n.notifications.length-1&&(c=function(){s.elm.animate({opacity:1},{duration:100,queue:!0})}),0!=t){var i=n.notifications[t-1].elm;d=d+i.outerHeight()+5,e.elm.animate({top:d+"px"},100,c)}else d=s.elm.outerHeight()+5,e.elm.animate({top:d+"px"},100,c)})}else s.elm.animate({opacity:1},100);n.notifications.unshift(s),r&&(s.time=i,s.elm.find(".-notification-timer").animate({width:0},i),s.timeout=setTimeout(function(){n.deleteNotification(s)},s.time))})},showError:function(e,t){t=_.isUndefined(t)?5e3:t,this.showMessage(e,"error",t)},showWarning:function(e,t){t=!0===t&&5e3||t,this.showMessage(e,"warning",t)},showSuccess:function(e,t){t=_.isUndefined(t)?5e3:t,this.showMessage(e,"success",t)},showMessage:function(e,t,i){var n=this;if(t=t||"error",i=_.isUndefined(i)?"warning"==t?0:5e3:i,/^\/[a-z]+/.test(e)){var o=$("body").data("lang");$.get("/html/"+o+e,function(e){n.show(t,e,i)})}else n.show(t,e,i)}};!function(e,t,i,n,o){"use strict";e.validator.addMethod("cMaxlength",e.validator.methods.maxlength,n.translate("Длина поля должна быть до {0} символов")),e.validator.addMethod("required",e.validator.methods.required,n.translate("Обязательное поле")),e.validator.addMethod("cRequired",e.validator.methods.required,n.translate("Обязательное поле")),e.validator.addMethod("identity",function(e,t){var i=e.trim();return this.optional(t)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(i)},n.translate("Введите корректный email")),e.validator.addMethod("email",e.validator.methods.identity,n.translate("Пожалуйста, введите правильный эл. адрес")),e.validator.addMethod("cMinCurrency",e.validator.methods.min,e.validator.format(n.translate("Минимальная сумма платежа - {0}руб."))),e.validator.addMethod("phone",function(e,t){var i=e.trim();return this.optional(t)||/^[+]?(\d)+$/i.test(i)},n.translate("Только цифры и +. Пример: +79123456789")),e.validator.addClassRules({"dynamic-form-required":{cRequired:!0},"dynamic-form-text":{cMaxlength:100},"dynamic-form-textarea":{cMaxlength:1e3},"dynamic-form-phone":{phone:!0},"dynamic-form-email":{identity:!0},"dynamic-form-money":{cMinCurrency:0}});var a=function(e,t){this.type=e,this.options=t||{},this.selector=".dynamic-form-"+e,this.btnSelector=".dynamic-form-button-"+e};a.getSubmitHash=function(e){return{0:"thankyou-form-0",1:"thankyou-form-1",3:"thankyou-lead-form",5:"thankyou-lead-form",7:"thankyou-form-2"}[e]},t.extend(a,{formIsShow:function(t){e(document).trigger("dynamic-form-show."+t)},types:{FORM_TYPE_FEEDBACK:0,FORM_TYPE_CALLBACK:1,FORM_TYPE_ORDER:2,FORM_TYPE_LEAD:3,FORM_TYPE_PAY:4,FORM_TYPE_LEAD_MRB:5,FORM_TYPE_PRODUCT_IN_STOCK:7},tooltipError:{trigger:"custom",theme:"tooltipster-error",speed:0,positionTracker:!0,offsetY:-6,position:"top"}}),t.extend(a.prototype,{init:function(){var t=e(this.selector);e(document).on("dynamic-form-show."+this.type,function(){o.setTimeout(function(){this.addButtonEvent(),this.validateForm()}.bind(this),100)}.bind(this)),t.length&&(this.addButtonEvent(),this.validateForm())},destroy:function(){e(document).off("dynamic-form-show."+this.type),e(this.btnSelector).off("click")},addButtonEvent:function(){var t=this;e(this.btnSelector).on("click",function(){e(this).parent().parent().find(t.selector).submit()})},processErrors:function(e,i){return t.reduce(e,function(e,n){return e.concat(t.map(n,function(e,n){return{element:i.find("[name="+n+"]"),message:t.values(e)[0]}}))},[])},validateForm:function(){var r=e(this.selector),s=this;r.each(function(){var r=e(this),d=r.validate({submitHandler:function(){
if("function"==typeof s.options.beforeSubmit&&s.options.beforeSubmit(),r.locked)return!1;r.locked=!0,r.ajaxSubmit({dataType:s.options.dataType||"json",success:function(e,t,c){var l,u;if(r.locked=!1,"function"==typeof s.options.afterSubmit&&s.options.afterSubmit(e),!1===e.success)return void(e.errors?(l=s.processErrors(e.errors,r),d.errorList=l,d.showErrors()):(l=e.msg||n.translate("Ошибка при отправке формы"),i.showError(l)));r[0].reset(),i.showSuccess(n.translate("Форма успешно отправлена")),o.history.pushState("",document.title,o.location.pathname),(u=a.getSubmitHash(s.type))&&(o.location.hash=u)},error:function(e,t,i){this.success({success:!1,msg:i},t,e)}})},focusInvalid:!1,focusCleanup:!1,showErrors:function(i,n){var o=r.find("input, textarea"),s=r.hasClass("js-no-tooltip");o.each(function(){var t=e(this);t.removeClass("error").addClass("valid"),t.siblings(".errors").remove(),t.hasClass("tooltipstered")&&t.tooltipster("hide")}),t.forEach(n,function(t){var i,n=e(t.element);s?(i=e('<ul class="errors">'),i.append(e("<li>").text(t.message)),n.is('[type="checkbox"]')?n.next("label").after(i):n.after(i)):(n.hasClass("tooltipstered")||n.tooltipster(a.tooltipError),n.tooltipster("content",t.message),n.tooltipster("show")),n.removeClass("valid").addClass("error")})}})})}}),o.Nethouse=o.Nethouse||{},o.Nethouse.DynamicForm=a}(window.$,window._,window.ntNotification,window.view,window),function(e,t){"use strict";setTimeout(function(){e(document).ready(function(){new t(t.types.FORM_TYPE_LEAD_MRB,{dataType:"text",afterSubmit:function(){window.location.hash="lead-form-send"}}).init()})},1e3)}(window.$,window.Nethouse.DynamicForm),function(e){var t=function(t){var i=this;i.element=e(t),i.init()};e.extend(t.prototype,{init:function(){var e=this;e.currentForm=e.element.find("form"),e.formId=e.currentForm.attr("id"),e.loadEvents(),e.addValidateMethods(),e.initFormValidate()},loadEvents:function(){var t=this;e(document).on("click","#"+t.formId+" .payments",t.submitHandler.bind(t))},addValidateMethods:function(){e.validator.addMethod("required",e.validator.methods.required,view.translate("Обязательное поле")),e.validator.addMethod("email",e.validator.methods.email,view.translate("Пожалуйста, введите правильный эл. адрес")),e.validator.addMethod("maxlength",e.validator.methods.maxlength,e.validator.format(view.translate("Пожалуйста, не вводите более {0} символов"))),e.validator.addMethod("min",e.validator.methods.min,e.validator.format(view.translate("Минимальная сумма платежа - {0}руб.")))},initFormValidate:function(){var t=this;e(document).ready(function(){t.validation=e("#"+t.formId).validate(t)})},submitHandler:function(){var t,i=this,n=e("#"+i.formId),o=n.attr("action"),a=n.serialize();n.valid()&&e.post(o,a,function(n){if(!1===n.success)throw n.errors?(_.forEach(n.errors,function(e,t,i){i[t]=_.reduce(e,function(e,t){return[e,t].join("\n")},"")}),i.validation.showErrors(n.errors),_.uniq(_.values(n.errors)).join("")):(t="Ошибка при обработке формы оплаты",ntNotification.showError(t)),Error(t);var o=document.createElement("form");o.setAttribute("action",n.gateway.url),o.setAttribute("method",n.gateway.method),_.forEach(n.gateway.query,function(e,t){var i=document.createElement("input");i.type="hidden",i.name=t,i.setAttribute("value",e),o.appendChild(i)}),e("body").append(o),o.submit()},"json")}}),setTimeout(function(){e(document).ready(function(){_.map(e(".mrb-form_payment"),function(e){new t(e)})})},1e3)}(jQuery),function(e,t){"use strict";e(document).ready(function(){new t(t.types.FORM_TYPE_LEAD).init()})}(window.$,window.Nethouse.DynamicForm),function(e){function t(i){var n={url:"",name:"",size:0,timestamp:0,type:t.TYPE_IMAGE};i=e.extend({},n,i),this.url=i.url,this.name=i.name,this.size=i.size,this.timestamp=i.timestamp,this.type=i.type}window.Nethouse=window.Nethouse||{};var i=window.Nethouse;t.TYPE_IMAGE=1,t.prototype.properties=["url","name","size","timestamp","type"],t.prototype.toInputFields=function(e,t){var i=document.createElement("input"),n=document.createElement("div");return n.className="js-file-fields js-file-fields_"+e,i.className="js-file-field",i.type="hidden",this.properties.forEach(function(o){i.name=t+"["+e+"]["+o+"]",i.value=this[o],n.appendChild(i),i=i.cloneNode(!0)}.bind(this)),n},i.FileModel=t}(window._),function(){function e(e,t){this.filters=[],this.path=t.path,this.maxFiles=t.maxFiles||0,this.fieldName=t.fieldName||"file",this.beforeUpload=this.beforeUpload||function(){};var i=document.createElement("input");i.name="files",i.type="file",t.multiple&&(i.multiple="multiple"),e.appendChild(i),e.className+=" fileapi",this.events={},window.FileAPI.event.on(i,"change",this.inputChanges.bind(this))}function t(t,i){i=window.FileAPI.extend({path:"/putimg"},i),e.call(this,t,i)}window.Nethouse=window.Nethouse||{};var i=1e4,n=window.Nethouse;e.Errors={MAX_SIZE:1,MIN_SIZE:2,EXTENSION:3,MAX_WIDTH:4,MAX_HEIGHT:5,MIN_WIDTH:6,MIN_HEIGHT:7,MAX_FILES_COUNT:8},e.MB=FileAPI.MB,e.KB=FileAPI.KB,e.prototype.call=function(e){var t=Array.prototype.slice.call(arguments,1);this.events[e]&&this.events[e].forEach(function(e){e.apply(this,t)}.bind(this))},e.prototype.on=function(e,t){return this.events[e]=this.events[e]||[],this.events[e].push(t),this},e.prototype.inputChanges=function(t){var i=window.FileAPI,n=i.getFiles(t);i.filterFiles(n,function(e,t){for(var i=0;i<this.filters.length;i++)if(!this.filters[i](e,t))return!1;return!0}.bind(this),function(t,n){if(this.call("before",t,n),t.length){this.maxFiles&&t.length>this.maxFiles&&(this.call("error",e.Errors.MAX_FILES_COUNT,{filesCount:t.length,maxFilesCount:this.maxFiles}),t=t.slice(0,this.maxFiles)),this.beforeUpload(t,n);var o={url:this.path,upload:function(e,t){this.call("upload",e,t)}.bind(this),progress:function(e,t,i,n){this.call("progress",e,t,i,n)}.bind(this),filecomplete:function(e,t,i,n){this.call("filecomplete",e,t,i,n)}.bind(this),complete:function(e,t){this.call("complete",e,t)}.bind(this),cache:!0};o.files={},o.files[this.fieldName]=t,i.upload(o)}}.bind(this)),i.reset(t.currentTarget)},e.prototype.addFileSizeFilter=function(t,i){return i=i||0,this.filters.push(function(n){return n.size>t?(this.call("error",e.Errors.MAX_SIZE,{file:n,maxSize:t}),!1):!(n.size<i)||(this.call("error",e.Errors.MIN_SIZE,{file:n,minSize:i}),!1)}.bind(this)),this},e.prototype.addExtensionFilter=function(t){var i=new RegExp("^.+\\.("+t.join("|")+")$","i");return this.filters.push(function(t){return!!i.test(t.name)||(this.call("error",e.Errors.EXTENSION,{file:t}),!1)}.bind(this)),this},n=n||{},n.Uploader=e,t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.prototype.addMaxSizeFilter=function(t,i){return this.filters.push(function(n,o){return t&&o.width>t?(this.call("error",e.Errors.MAX_WIDTH,{file:n,width:o.width,maxWidth:t}),!1):!(i&&o.height>i)||(this.call("error",e.Errors.MAX_HEIGHT,{file:n,height:o.height,maxHeight:i}),!1)}.bind(this)),this},t.prototype.addMinSizeFilter=function(t,i){return this.filters.push(function(n,o){return t&&o.width<t?(this.call("error",e.Errors.MIN_WIDTH,{file:n,width:o.width,minWidth:t}),!1):!(i&&o.height<i)||(this.call("error",e.Errors.MIN_HEIGHT,{file:n,height:o.height,minHeight:i}),!1)}.bind(this)),this},t.prototype.preview=function(e,t,i){return this.previewSize={width:e,height:t},this.events.progress=[function(e,t){var i=document.querySelectorAll(".upload-image_"+t.id+" .upload-image__progress")[0],n=e.loaded/e.total*100;i&&n<90&&(i.style.top=e.loaded/e.total*100+"%")}],this.events.filecomplete=[function(e,t,i){var n=document.querySelectorAll(".upload-image_"+i.id)[0];if(n){if(e)return void(n.className+=" upload-image_fail");n.className+=" upload-image_uploaded",n.querySelectorAll(".upload-image__progress")[0].style.top="100%"}}],this.events.preview=i,this},t.prototype.beforeUpload=function(e){if(this.events.preview){var t=window.FileAPI;t.each(e,function(e){e.id=i++,t.Image(e).preview(this.previewSize.width,this.previewSize.height).get(function(t,i){var n=document.createElement("div");n.className="upload-image upload-image_"+e.id,n.innerHTML='<div class="upload-image__progress"></div><div class="upload-image-file__status"></div>',n.appendChild(i),this.events.preview(n,e.id)}.bind(this))}.bind(this))}},n.ImageUploader=t}(),function(e){"use strict";var t={init:function(){this.addMobileSelector()},addMobileSelector:function(){!0===isMobile.any&&e("body").addClass("mobile-device")}};e(document).ready(function(){t.init()})}(jQuery);
!function(n){"use strict";function i(){var i=n(".ui.accordion");i.accordion({exclusive:!1,animateChildren:!1}),i.on("click",function(n){n.stopPropagation()})}n(document).ready(function(){i(),n(document).on("widget_set_content",function(n,o){11==o&&i()}.bind(this))})}(window.jQuery);
!function(e){e.fn.agile_carousel=function(n){return n=e.extend({timer:0,continuous_scrolling:!1,transition_type:"slide",transition_time:600,number_slides_visible:1,change_on_hover:"",control_set_1:"",control_set_2:"",control_set_3:"",control_set_4:"",control_set_5:""},n),this.each(function(){function o(t){if(""!==Q){C="ac_click";var n=Q.split(",");e.inArray(t,n)!=-1&&(C="ac_hover")}return C}function s(t){T===!1&&R<2&&(1==t?(lt>0&&(_t.addClass("ac_disabled"),_t.data("options").disabled=!0),ut>0&&(rt.addClass("ac_disabled"),rt.data("options").disabled=!0)):(lt>0&&(_t.removeClass("ac_disabled"),_t.data("options").disabled=!1),ut>0&&(rt.removeClass("ac_disabled"),rt.data("options").disabled=!1)),t==l?(bt>0&&(ct.addClass("ac_disabled"),ct.data("options").disabled=!0),vt>0&&(pt.addClass("ac_disabled"),pt.data("options").disabled=!0)):(bt>0&&(ct.removeClass("ac_disabled"),ct.data("options").disabled=!1),vt>0&&(pt.removeClass("ac_disabled"),pt.data("options").disabled=!1))),T===!1&&R>1&&(t<=R?(lt>0&&(_t.addClass("ac_disabled"),_t.data("options").disabled=!0),ut>0&&(rt.addClass("ac_disabled"),rt.data("options").disabled=!0)):(lt>0&&(_t.removeClass("ac_disabled"),_t.data("options").disabled=!1),ut>0&&(rt.removeClass("ac_disabled"),rt.data("options").disabled=!1)),t>=l-R+tt?(bt>0&&(ct.addClass("ac_disabled"),ct.data("options").disabled=!0),vt>0&&(pt.addClass("ac_disabled"),pt.data("options").disabled=!0)):(bt>0&&(ct.removeClass("ac_disabled"),ct.data("options").disabled=!1),vt>0&&(pt.removeClass("ac_disabled"),pt.data("options").disabled=!1)))}function i(t){it.find(".ac_selected").removeClass("ac_selected"),it.find(".slide_number_"+t).addClass("ac_selected")}function a(t){if(I=e(t)[0],I.disabled!==!0){if(w=I.button_action,t=I.go_to,q!==!1&&(k=q),z=k-1,M=e(at).eq(z),R<2&&("next"==w&&k<l?q=k+1:"next"==w&&k==l&&(q=1),"previous"==w&&k>1?q=k-1:"previous"==w&&1==k&&(q=l)),R>1)if("next"==w&&k<l-R+tt?q=et[Math.ceil(k/R)]:"next"==w&&k>=l-R+tt&&R>1&&(q=1),"previous"==w&&k>R&&R>1){var n=Math.floor(k/R);n-=1,q=et[n]}else"previous"==w&&k<=R&&R>1&&(q=xt);"direct"==w&&(q=t),P=q-1,N=e(at).eq(P),i(q),ft>0&&ht.html(q),P!=z&&("slide"==S&&R>1&&dt.stop().animate({left:(q*B-B)*-1+"px"},{duration:U}),"slide"==S&&1==R&&(t="",("next"==w||q>k&&"direct"==w)&&(N.css({top:0,left:B}),t=B*-1),("previous"==w||q<k&&"direct"==w)&&(N.css({top:0,left:B*-1}),t=B),M.stop().animate({left:t+"px"},{duration:U,complete:gt}),N.stop().animate({left:"0px"},{duration:U})),"fade"==S&&1==R&&(at.not(M,N).css({top:"-5000px",left:0,"z-index":0,opacity:0}),w&&(N.css({top:0,left:0,"z-index":20}),M.css({"z-index":10,opacity:1})),N.stop().animate({opacity:1},{duration:U,complete:mt})))}s(q),i(q)}function d(){yt.length>0&&(yt.html("play"),yt.data("options").paused=!0,yt.addClass("play_button")),clearInterval($)}function _(){a(Z)}var l=0,r="",u="",c="",b="",p="",v="",h="",f="",m="",g="",x="",y="",C="ac_click",I="",w="",k="",q=!1,z="",P="",M="",N="",T=n.continuous_scrolling,j=n.carousel_outer_width,A=n.carousel_outer_height,O=n.carousel_data,Q=n.change_on_hover,B=n.slide_width,D=n.slide_height,E=n.control_set_1,F=n.control_set_2,G=n.control_set_3,H=n.control_set_4,J=n.control_set_5,K=n.no_control_set,L=n.persistent_content,R=n.number_slides_visible,S=n.transition_type,U=n.transition_time,V=n.timer,W="",X="",Y=X="",Z="",$="";e.each(O,function(){l++});for(var tt=l%R,et=[],W="",nt=0,ot=0,ot=0;ot<l;ot++)0===ot&&(c+="<div class='group_numbered_buttons_container button_container'>"),X=Math.floor((ot+1)/R)*R+1,X!==W&&X<=l&&(et[nt]=X,c+="<div class='slide_number_"+X+" group_numbered_button slide_button "+o("group_numbered_buttons")+'\' data-options=\'{"button_type":"group_numbered_button","button_action":"direct","go_to":'+X+', "trigger_type":"'+C+'","disabled": false}\'>'+(nt+1)+"</div>",W=X,nt++),ot===l-1&&(c+="</div>");v+='<span class=\'pause_button slide_button pause\' data-options=\'{"button_type":"pause_button","trigger_type": "none","disabled": false,"paused": false}\'>Pause</span>',h+="<span class='previous_next_button previous_button slide_button "+o("previous_button")+'\' data-options=\'{"button_type":"previous_button","button_action":"previous","trigger_type": "'+C+'","disabled": false}\'>Prev</span>',f+="<span class='previous_next_button next_button slide_button "+o("next_button")+'\' data-options=\'{"button_type":"next_button","button_action":"next","trigger_type": "'+C+'","disabled": false}\'>Next</span>',m+="<div class='hover_previous_next_button hover_previous_button slide_button "+o("hover_previous_button")+'\' data-options=\'{"button_type":"hover_previous_button","button_action":"previous","trigger_type": "'+C+"\",\"disabled\": false}'><span style='opacity: 0;' class='hover_previous_next_button_inner'>Prev</span></div>",g+="<div class='hover_previous_next_button hover_next_button slide_button "+o("hover_next_button")+'\' data-options=\'{"button_type":"hover_next_button","button_action":"next","trigger_type": "'+C+"\",\"disabled\": false}'><span style='opacity: 0;' class='hover_previous_next_button_inner'>Next</span></div>",x+="<span class='slide_count'>"+l+"</span>",y+="<span class='current_slide_number'>1</span>",r+="<div class='agile_carousel' style='overflow: hidden; position: relative; width: "+j+"px; height: "+A+"px;'>";var st,it=e(this),ot=1;for(st in O)O.hasOwnProperty(st)&&(X=O[st],W=X.content,j=X.thumbnail_button,X=X.content_button,1===ot&&(r+="<div class='slides' style='width: "+B*l+"px; height: "+D+"px;'>"),W&&(r+="<div class='slide_"+ot+" slide' style='border: none; margin: 0; padding: 0; height: "+D+"px; width: "+B+"px;'>"+W+"</div>"),ot===l&&(r+="</div>"),1==ot&&(u+="<div class='numbered_buttons_container  button_container'>"),u+="<div class='slide_number_"+ot+" numbered_button slide_button "+o("numbered_buttons")+'\' data-options=\'{"button_type":"numbered_button","button_action":"direct","go_to":'+ot+', "trigger_type":"'+C+'","disabled": false}\'>'+ot+"</div>",ot==l&&(u+="</div>"),j&&(1==ot&&(b+="<div class='thumbnail_buttons_container  button_container'>"),b+="<div class='slide_number_"+ot+" thumbnail_button slide_button "+o("thumbnails")+'\'  data-options=\'{"button_type":"thumbnail_button","button_action":"direct","go_to":'+ot+',"trigger_type": "'+C+'","disabled": false}\'>'+j+"</div>",ot==l&&(b+="</div>")),X&&(1==ot&&(p+="<div class='content_buttons_container  button_container'>"),p+="<div class='slide_number_"+ot+" content_button_"+ot+" content_button slide_button "+o("content_buttons")+'\' data-options=\'{"button_type":"content_button","button_action":"direct","go_to":'+ot+',"trigger_type": "'+C+"\",\"disabled\": false}'><div class='content_button_inner'>"+X+"</div></div>",ot==l&&(p+="</div>")),ot++);O=function(t,e){var n="";if(""!==t){e&&(n+="<div class='control_set_"+e+" control_set'><div class='control_set_"+e+"_inner control_set_inner'>");var o=t.split(",");for(nt=0;nt<o.length;nt++)"numbered_buttons"==o[nt]&&(n+=u),"group_numbered_buttons"==o[nt]&&(n+=c),"thumbnails"==o[nt]&&(n+=b),"content_buttons"==o[nt]&&(n+=p),"pause_button"==o[nt]&&(n+=v),"previous_button"==o[nt]&&(n+=h),"next_button"==o[nt]&&(n+=f),"hover_previous_button"==o[nt]&&(n+=m),"hover_next_button"==o[nt]&&(n+=g),"slide_count"==o[nt]&&(n+=x),"current_slide_number"==o[nt]&&(n+=y);e&&(n+="</div></div>"),r+=n}},n.control_set_1&&O(E,1),n.control_set_2&&O(F,2),n.control_set_3&&O(G,3),n.control_set_4&&O(H,4),n.control_set_5&&O(J,5),n.no_control_set&&O(K),L&&(r+=L),r+="</div>",it.html(r);var at=it.find(".slide"),dt=it.find(".slides");it.find(".slide_button"),E=it.find(".agile_carousel"),it.find(".previous_button, .hover_previous_button"),it.find(".next_button, .hover_next_button");var _t=it.find(".previous_button"),lt=_t.length,rt=it.find(".hover_previous_button"),ut=rt.length,ct=it.find(".next_button"),bt=ct.length,pt=it.find(".hover_next_button"),vt=pt.length,ht=it.find(".current_slide_number"),ft=ht.length;if(1==R&&(at.eq(0).css({position:"absolute",top:0,left:0}),at.slice(1,l).css({position:"absolute",top:"-5000px",left:0}),dt.css("width",B+"px")),R>1)for(E.css("width",R*B+"px"),E=0,E=1;E<=l;E++)at.eq(E).css({position:"absolute",top:0,left:B*E+"px"});var mt=function(){M.css({"z-index":10,top:-5e3})},gt=function(){M.css({position:"absolute",top:"-5000px",left:0})};s(1),ft>0&&ht.html(1),i(1);var k=1,xt=et[et.length-1],E=it.find(".ac_click"),F=it.find(".ac_hover");0!==V&&($=setInterval(_,V));var yt=it.find(".pause_button");e(E).click(function(){d(),it.find(":animated").length<1?a(e(this).data().options):(Y=e(this),"next"!=Y.data("options").button_action&&"previous"!=Y.data("options").button_action&&(t=setInterval(function(){dt.find(":animated").length<1&&(a(Y.data().options),clearInterval(Y.data("options").timeout))},30),Y.data("options").timeout=t))}),e(F).hover(function(){d(),dt.find(":animated").length<1?a(e(this).data().options):(Y=e(this),t=setInterval(function(){dt.find(":animated").length<1&&(a(Y.data().options),clearInterval(Y.data("options").timeout))},30),Y.data("options").timeout=t)},function(){Y=e(this),clearInterval(Y.data("options").timeout)}),Z={button_action:"next",button_type:"pause",disabled:!1,trigger_type:"ac_click"},yt.click(function(){var t=e(this);t.data("options").paused===!0?(clearInterval($),yt.html("pause"),yt.data("options").paused=!1,yt.addClass("pause_button"),yt.removeClass("play_button"),a(Z),$=setInterval(_,V)):t.data("options").paused===!1&&(d(),clearInterval($))}),e(".hover_previous_next_button").hover(function(){e(this).find(".hover_previous_next_button_inner").stop().fadeTo("fast",.85)},function(){e(this).find(".hover_previous_next_button_inner").stop().fadeTo("fast",0)})})}}(jQuery);
!function(t){"use strict";var i=function(i,e,n){n=n||[],this.options=t.extend({field:"name",input:".js-filter__input",collection:".js-filter__item"},e),this.$element=i,this.data=n,this.$collectionItems=i.find(this.options.collection),this.initInput()},e=i.prototype;e.initInput=function(){this.$input=this.$element.find(this.options.input),this.$input.on("keyup",function(){this.filter(this.$input.val())}.bind(this))},e.filter=function(i){if(this.$collectionItems.show(),i=String(i).trim(),!i)return void this.$element.trigger("collection-filtered",{filtered:this.data});var e=new RegExp(i,"i"),n=this.data.filter(function(t){return e.test(t[this.options.field])}.bind(this));this.$element.trigger("collection-filtered",{filtered:n}),this.$collectionItems.filter(function(i,n){return!e.test(t(n).data(this.options.field))}.bind(this)).hide()},t.fn.collectionFilter=function(e,n){return e=e||{},this.each(function(){this.collectionFilter||(this.collectionFilter=new i(t(this),e,n))})}}(window.jQuery);
+function(e){"use strict";function n(){e(".nav-tabs > li > a").click(function(n){n.preventDefault(),e(this).tab("show")})}function t(){e("select").dropdown({transition:"slide down"}),e(document).on("widget_set_content",function(){e("select").dropdown({transition:"slide down"})})}function i(){e(".posts-slider").ContentSlider({},{slideDivider:2}),e(".articles-slider").ContentSlider({},{slideDivider:2}),e(document).on("widget_set_content",function(n,t){switch(t){case Nethouse.WIDGETS.TYPE_POSTS:e(".posts-slider").ContentSlider({},{slideDivider:2});break;case Nethouse.WIDGETS.TYPE_ARTICLES:e(".articles-slider").ContentSlider({},{slideDivider:2})}}),e(".comments-slider").ContentSlider(),e(document).on("comments_block_change",function(n){var t=function(){e(".comments-slider").ContentSlider()};_.delay(t,500)})}e(document).ready(function(){n(),t(),i()})}(jQuery);
!function(t,i){"use strict";var n=function(t,n){i.each(n,function(n,s){i.isFunction(t)?t.prototype[s]=n:i.isObject(t)&&(t[s]=n)})},s=[].slice,e={slides:"article",showBy:1,slideDivider:1,rewindOnEnd:!1,easing:"easeInOutCubic",duration:500},o=function(){function t(){this.opts=1<=arguments.length?s.call(arguments,0):[],this._apply(),this._init()}return t.prototype.controls={prev:".prev",next:".next"},t.prototype.options=i.clone(e),t.prototype.current=0,t.prototype.slidesCount=0,t.prototype.slideWidth=0,t}();n(o,{_apply:function(){var n=this.opts[0],s=this.opts[1],o=this.opts[2];o=o||{},i.isUndefined(n)||(this.container=t(n)),!i.isUndefined(s)&&i.has(s,"prev")&&i.has(s,"next")&&(this.controls=i.extend(this.controls,{prev:t(s.prev),next:t(s.next)})),i.isObject(o)&&!i.isEmpty(o)?this.options=i.extend(this.options,o):this.options=i.extend(this.options,e),delete this.opts},_init:function(){this.slidesCount=Math.ceil(this.slides().length/this.options.slideDivider),this.slideWidth=this.container.parent().width()/this.options.showBy,this.listen()},listen:function(t){var n=this;i.isUndefined(t)&&(t=!0),i.each(this.controls,function(s,e){var o=i.isString(s)?n.container.parent().find(s):s;t?o.on("click",n[e].bind(n)):o.off()})},slides:function(){return this.container.children(this.options.slides)},offsetOptions:function(t,i){return i=i||1,function(){var n;switch(t){case"backward":if(n=this.current-i,n<0)return;break;case"forward":if(n=this.current+i,n>this.slidesCount-1){if(!this.options.rewindOnEnd)return;n=0}break;case"rewind":n=0;break;case"fast-forward":n=this.slidesCount-1}return this.current=n,{left:"-"+this.slideWidth*n+"px"}}.call(this)},move:function(t,n){var s,e;t=t||"forward",n=n||1,e=i.pick(this.options,"easing","duration"),s=this.offsetOptions(t,n),this.slides().animate(s,e)},rewind:function(){this.move("rewind")},next:function(){this.move("forward")},prev:function(){this.move("backward")},reset:function(t){this.options=i.extend(this.options,e,t),this.move("rewind"),this.listen(!1),this._init()}}),t.fn.ContentSlider=function(i,n){return void 0==i&&(i={}),void 0==n&&(n={}),this.each(function(){var s=t(this),e=s.data("content.slider");void 0==e&&s.data("content.slider",e=new o(this,i,n))})}}(jQuery,_);
+function(t){"use strict";function n(n){return this.each(function(){var e=t(this),i=e.data("bs.tab");i||e.data("bs.tab",i=new a(this)),"string"==typeof n&&i[n]()})}var a=function(n){this.element=t(n)};a.TRANSITION_DURATION=150,a.prototype.show=function(){var n=this.element,a=n.closest("ul:not(.dropdown-menu)"),e=n.data("target");if(e||(e=n.attr("href"),e=e&&e.replace(/.*(?=#[^\s]*$)/,"")),!n.parent("li").hasClass("active")){var i=a.find(".active:last a"),r=t.Event("hide.bs.tab",{relatedTarget:n[0]}),s=t.Event("show.bs.tab",{relatedTarget:i[0]});if(i.trigger(r),n.trigger(s),!s.isDefaultPrevented()&&!r.isDefaultPrevented()){var o=t(e);this.activate(n.closest("li"),a),this.activate(o,o.parent(),function(){i.trigger({type:"hidden.bs.tab",relatedTarget:n[0]}),n.trigger({type:"shown.bs.tab",relatedTarget:i[0]})})}}},a.prototype.activate=function(n,e,i){function r(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),n.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),o?(n[0].offsetWidth,n.addClass("in")):n.removeClass("fade"),n.parent(".dropdown-menu")&&n.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),i&&i()}var s=e.find("> .active"),o=i&&t.support.transition&&(s.length&&s.hasClass("fade")||!!e.find("> .fade").length);s.length&&o?s.one("bsTransitionEnd",r).emulateTransitionEnd(a.TRANSITION_DURATION):r(),s.removeClass("in")};var e=t.fn.tab;t.fn.tab=n,t.fn.tab.Constructor=a,t.fn.tab.noConflict=function(){return t.fn.tab=e,this};var i=function(a){a.preventDefault(),n.call(t(this),"show")};t(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',i).on("click.bs.tab.data-api",'[data-toggle="pill"]',i)}(jQuery),+function(t){"use strict";function n(){var t=document.createElement("bootstrap"),n={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var a in n)if(void 0!==t.style[a])return{end:n[a]};return!1}t.fn.emulateTransitionEnd=function(n){var a=!1,e=this;t(this).one("bsTransitionEnd",function(){a=!0});var i=function(){a||t(e).trigger(t.support.transition.end)};return setTimeout(i,n),this},t(function(){t.support.transition=n(),t.support.transition&&(t.event.special.bsTransitionEnd={bindType:t.support.transition.end,delegateType:t.support.transition.end,handle:function(n){if(t(n.target).is(this))return n.handleObj.handler.apply(this,arguments)}})})}(jQuery);
+function(t){"use strict";function n(n,i){var o=n.find(".small-cart"),e=t(window).width()-(o.offset().left+o.outerWidth()),c=t(document);c.scrollTop()>i?"fixed"!=o.css("position")&&o.is(":visible")&&o.css({position:"fixed",top:0,right:e}):o.css({position:"",top:"",right:""})}function i(){var i=t(".cart-widget");if(i.length){var o=i.find(".quantity-items"),e=t(document),c=o.length?parseInt(o.html()):0,r=t(".top-header").outerHeight()+t(".site-panel").outerHeight()+t(".info-panel").outerHeight();e.on("scroll",function(){n(i,r)}),e.on("click touchstart",function(n){n&&(i[0].contains(n.target)||t(".js-order-product").has(n.target).length)||i.find(".small-cart").hide()}),e.on("cart.update",function(e,a){var s=i.find(".cart-is-empty"),l=i.find(".small-cart");s.html("Корзина пуста"),c=0,!l.is(":visible")&&a&&(l.stop(),l.fadeIn({duration:200,start:function(){n(i,r)}})),t("#products-cart-left-show").find(".cart-item .num-items").each(function(){var n=t(this);c+=parseInt(n.val())}),o.html(c)}),i.on("click",".js-close-cart",function(){return i.find(".small-cart").toggle(),!1}),i.find(".cart-content").on("click",function(){i.find(".small-cart").toggle()})}}t(document).ready(function(){i()})}(jQuery);
!function(t,n,i){"use strict";function s(){if(n.ymaps){var i=t.Deferred();return i.resolve(n.ymaps),i.promise()}return t.getScript("//api-maps.yandex.ru/2.1/?mode=release&lang=ru_RU").then(function(){return n.ymaps}.bind(this))}function e(t,n){this.element=t,this.points=n,s().then(function(t){this.ymaps=t,this.init(n)}.bind(this))}var o=e.prototype;o.init=function(){this.ymaps.ready(function(){this.ballonContentLayout(),this.cluster=this.initCluster(),this.map=this.initMap(),this.map.setBounds(this.getBounds()),this.map.geoObjects.add(this.cluster)}.bind(this))},o.initCluster=function(){var t=new this.ymaps.Clusterer({groupByCoordinates:!1,zoomMargin:40,clusterBalloonItemContentLayout:this.balloonLayout}),n=this.preparePoints();return t.add(n),t},o.updateCluster=function(t){this.points=t;var n=this.preparePoints();this.cluster.removeAll(),this.cluster.add(n),n.length&&this.map.setBounds(this.getBounds())},o.getBounds=function(t){t=t||.003;var n=this.cluster.getBounds();return n[0]=n[0].map(function(n){return Number(n)-t}),n[1]=n[1].map(function(n){return Number(n)+t}),n},o.preparePoints=function(){return this.points.map(function(t){return t.balloonContentHeader=t.name,t.hintContent=t.name,new this.ymaps.Placemark([t.longitude,t.latitude],t,{balloonContentLayout:this.balloonLayout})}.bind(this))},o.initMap=function(){var t=new this.ymaps.Map(this.element,{center:[0,0],zoom:9,controls:[]},{autoFitToViewport:"always"});return t.controls.add("zoomControl",{position:{top:10,left:10}}),t.behaviors.disable("scrollZoom"),t},o.ballonContentLayout=function(){var i=this,s=this.ymaps.templateLayoutFactory.createClass('<div class="shipping-map__balloon"><b class="shipping-map__name">{{properties.name}}</b><br /><button class="js-shipping__map-button shipping-map__button">'+n.view.translate("shipping_select_outpost")+"</button></div>",{build:function(){s.superclass.build.call(this),this.selectOutpost=this.selectOutpost.bind(this),t(".js-shipping__map-button").bind("click",this.selectOutpost)},clear:function(){t(".js-shipping__map-button").unbind("click",this.selectOutpost),s.superclass.clear.call(this)},selectOutpost:function(){t(i.element).trigger(t.fn.shippingMap.events.pointSelect,this._data.properties._data),i.map.destroy()}});this.balloonLayout=s},t.fn.shippingMap=function(t){return this.each(function(){this.shippingMap?this.shippingMap.updateCluster(t):this.shippingMap=new e(this,t)})},t.fn.shippingMap.events={pointSelect:"shipping-select-point"}}(window.jQuery,window,document);
!function(t,i,e){"use strict";var s=i.Nethouse.Modal,n=function(i,e){this.options=t.extend({elms:{city:".js-shipping__city",pickup:".js-shipping__pickup",outpostSelect:".js-shipping__outpost-select",outposts:".js-outposts",outpostModal:".js-outpost__modal",outpostsTemplate:".js-outposts__template",outpostsItem:".js-outposts__item",outpostsMap:".js-outposts__map",rates:".js-shipping__rates",rate:".js-shipping__rate",rateElm:".js-shipping__rate-elm",shipment:".js-shipping__shipment"},activeRateCls:"shipping__rate_active",citiesUrl:"/shipping/city-autocomplete?name={query}",ratesUrl:"/shipping/rates"},e),this.$element=i,this.ratesIsGet=!1,this.$skipShipping=!1,this.init()},o=n.prototype;o.init=function(){this.$rates=this.$element.find(this.options.elms.rates),this.$city=this.$element.find(this.options.elms.city),this.$rates.length&&(this.$city.length?(this.initCity(),this.$element.on(n.events.updateRates,function(){this.city?this.getRatesHtml():this.$element.trigger(n.events.rateNotSelected)}.bind(this)),setTimeout(function(){this.$element.trigger(n.events.rateNotSelected)}.bind(this),100)):(this.getRatesHtml(),this.$element.on(n.events.updateRates,function(){this.getRatesHtml()}.bind(this))))},o.collectPoints=function(){var i=[],e=this;return t(this.options.elms.outpostsItem).each(function(){var s=t(this),n=e.outpostItemData(s);i.push(n)}),i},o.disableScroll=function(e){t("html").hasClass("touch")&&t(i).trigger("scroll:disable",e)},o.initCity=function(){var s=this.$city.find(".search");setTimeout(function(){this.$city.dropdown({apiSettings:{url:this.options.citiesUrl,cache:!1,beforeSend:function(t){return!!t.urlData.query.length},onFailure:function(){this.$skipShipping=!0,this.insertRatesHtml('<tr><td></td><td colspan="5">Продолжайте оформление заказа. По условиям доставки менеджер свяжется с вами дополнительно.</td></tr>')}.bind(this),onResponse:function(t){return t.cities&&t.cities.length?(t.cities.forEach(function(t){t.value=t.city_id,t.name=t.full_name}),{success:!0,results:t.cities}):{success:!0,results:[{name:s.val(),value:0}]}}.bind(this)},message:{noResults:i.view.translate("shipping_city_not_found")},direction:t("html").hasClass("touch")?"upward":"auto",sortSelect:!0,allowReselection:!0,selectOnKeydown:!1,minCharacters:1,context:e.body,forceSelection:!1,saveRemoteData:!1,duration:0,onHide:function(){var i=t(this);s.val()&&(s.val(""),i.find(".text").removeClass("filtered").html(i.dropdown("get text")),i.dropdown("refresh"))},onChange:function(t,i){this.city={id:t,name:i},this.$city.removeClass("error"),this.$city.removeClass("focused"),s.blur(),this.getRatesHtml(),this.disableScroll(!1)}.bind(this)})}.bind(this)),this.$city.find(".js-dropdown__close").on("click",function(){this.$city.removeClass("focused"),s.blur(),this.disableScroll(!1)}.bind(this)),s.on("focus",function(){this.$city.removeClass("error"),this.$city.hasClass("focused")||(this.disableScroll(!0),this.$city.addClass("focused"))}.bind(this)),s.on("click",function(){return setTimeout(function(){this.$city.dropdown("show"),this.$city.dropdown("set visible",!0)}.bind(this),100),!1}.bind(this))},o.getRatesHtml=function(i){return i=i||{},this.city&&(i.address_to={carrier_address_id:this.city.id,global:{locality:this.city.name}}),i.promocode=t(".js-promocode-input").val(),t.ajax({type:"POST",url:this.options.ratesUrl,data:JSON.stringify(i),contentType:"application/json; charset=utf-8"}).done(function(t){this.insertRatesHtml(t),this.rateChanged(),this.$element.trigger(n.events.rateSelected),this.ratesIsGet=!0}.bind(this)).fail(function(){this.$skipShipping=!0,this.insertRatesHtml('<tr><td></td><td colspan="5">Продолжайте оформление заказа. По условиям доставки менеджер свяжется с вами дополнительно.</td></tr>')}.bind(this))},o.rateChanged=function(){var t=this.options.elms,i=this.$element.find(t.rate+":checked"),e=this.$element.find(t.shipment);this.$element.find(t.rateElm).removeClass(this.options.activeRateCls),i.length&&(i.parents(t.rateElm).addClass(this.options.activeRateCls),this.$element.trigger(n.events.rateChanged,{id:i.val(),shipment:e.val(),pickupPoint:this.$pickup.val(),price:Number(i.data("price"))}),this.$element.trigger(n.events.rateSelected))},o.insertRatesHtml=function(t){this.$rates.html(t),this.initOutpost(),this.$rates.find(this.options.elms.rate).on("change",function(){this.rateChanged()}.bind(this))},o.initOutpost=function(){this.$pickup=this.$rates.find(this.options.elms.pickup),this.$outpostSelect=this.$rates.find(this.options.elms.outpostSelect),this.$outpostSelect.on("click",function(){this.showOutpostModal()}.bind(this))},o.outpostItemData=function(t){return t.data()},o.setOutpostData=function(t){var i=this.options.elms;this.$pickup.val(t.value),this.getRatesHtml({shipment_id:this.$element.find(i.shipment).val(),pickup_point_id:t.value})},o.selectOutpostAddress=function(){var i=this;t(this.options.elms.outpostsItem).on("click",function(){var e=t(this),n=i.outpostItemData(e);i.setOutpostData(n),s.close()})},o.showOutpostModal=function(){var i=this.$element.find(this.options.elms.outpostsTemplate).html();s.openHtml(i,{open:function(){this.selectOutpostAddress();var i,e=t(this.options.elms.outpostModal),o=this.collectPoints(),h=e.find(this.options.elms.outpostsMap);e.find(this.options.elms.outposts).collectionFilter({},o).on("collection-filtered",function(t,i){h.shippingMap(i.filtered)}),i=h.shippingMap(o),i.on(t.fn.shippingMap.events.pointSelect,function(t,i){this.setOutpostData(i),this.rateChanged(),s.close()}.bind(this)),this.$element.trigger(n.events.outpostsOpen)}.bind(this)},!1)},o.rateSelected=function(){if(this.$skipShipping)return!0;if(!this.$rates.length)return!0;if(!this.ratesIsGet)return!1;var t=this.$element.find(this.options.elms.rate);return Boolean(!this.$city.length&&!t.length||t.filter(":checked").length)},o.citySelected=function(){return this.$skipShipping?(this.$city.removeClass("error"),!0):!this.$city.length||(this.$city.dropdown("get value")?(this.$city.removeClass("error"),!0):(this.$city.addClass("error"),!1))},n.events={rateNotSelected:"shipping-not-selected",rateSelected:"shipping-selected",rateChanged:"shipping-changed",updateRates:"shipping-update-rates",outpostsOpen:"shipping-open-outposts"},t.fn.shipping=function(){var t=arguments,i=Array.prototype.slice.call(t,1);return this.length?this.shippingItem?t.length?this.shippingItem[t[0]].apply(this.shippingItem,i):void 0:(this.shippingItem=new n(this),this):this},t.fn.shipping.events=t.extend({},n.events)}(window.jQuery,window,document);